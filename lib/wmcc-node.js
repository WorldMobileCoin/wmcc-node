module.exports=function(t){function e(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(t,e){t.exports=require("wmcc-core")},function(t,e){t.exports=require("assert")},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.node=t,this.events=[],this.init()}o(1);const s=o(0),{Lock:r}=s.utils,{Amount:i}=s.wmcc;n.prototype.init=function(){const t=this,e=(e,o)=>{let n=t.events.mempool;for(let s in n)t.emit(n[s].event,"mempool",n[s].el,{tx:e,view:o})};this.node.mempool.listeners("tx").filter(t=>t.toString()===e.toString()).length&&this.node.mempool.removeListener("tx",e),this.node.mempool.on("tx",e);const o=async(e,o)=>{let n=t.events.chain;for(let e in n)t.emit(n[e].event,"chain",n[e].el)};this.node.chain.listeners("block").filter(t=>t.toString()===o.toString()).length&&this.node.chain.removeListener("block",o),this.node.chain.on("block",o);const n=()=>{let e=t.events.balance;for(let o in e)t.emit(e[o].event,"balance",e[o].el)};this.node.walletdb.listeners("hook balance").filter(t=>t.toString()===n.toString()).length&&this.node.walletdb.removeListener("hook balance",n),this.node.walletdb.on("hook balance",n);const s=e=>{let o=t.events.miner;for(let n in o)t.emit(o[n].event,"miner",o[n].el,{attempt:e})};this.node.miner.listeners("miner block").filter(t=>t.toString()===s.toString()).length&&this.node.miner.removeListener("miner block",s),this.node.miner.on("miner block",s);const r=async(e,o)=>{let n=t.events.notification;for(let s in n)t.emit(n[s].event,"notification",n[s].el,{block:e,entry:o,prepend:!0})};this.node.miner.listeners("miner found").filter(t=>t.toString()===r.toString()).length&&this.node.miner.removeListener("miner found",r),this.node.miner.on("miner found",r),this.node.chain.db.on("rescan",()=>{t.node.walletdb.rescan(0)}),this.node.chain.db.on("block scan",(e,o)=>{$("preload").show(),$("preloadcontent").html(`<span class='scanning'>Scanning block ${o}: <a>${e}</a></span>`),t.node.chain.tip.height===o&&$("preload").hide()})},n.prototype.on=async function(t,e,o,n){this.events[e]||(this.events[e]=[]);const s={event:t,el:o};return this.events[e].filter((e,n)=>e.event===t||e.el===o).length||this.events[e].push(s),this.events[e]=this.events[e].map(t=>Object.assign(t,[s].find(e=>e&&t.event===e.event))),await this.emit(t,e,o,n)},n.prototype.add=async function(t,e,o,n){return await this.on(t,e,o,n)},n.prototype.emit=async function(t,e,o,n){try{let s;return s=n&&Object.keys(n).length?await this[t](...Object.values(n)):await this[t](),void(n&&n.append?o.append(s):n&&n.prepend?o.prepend(s):o.html(s))}catch(o){if("TypeError"!==o.name)throw o;console.log(`Unable to attach 'on' event for ${e}::${t}`)}},n.prototype.getBalance=async function(){return await this.node.info.wallet.getBalanceDetails(this.node.info.getAccountName())},n.prototype.getTotal=async function(t){const e=t||await this.getBalance();return i.text(e.total)},n.prototype.getAvailable=async function(t){const e=t||await this.getBalance();return i.text(e.available)},n.prototype.getPending=async function(t){const e=t||await this.getBalance();return i.text(e.pending)},n.prototype.getImmature=async function(t){const e=t||await this.getBalance();return i.text(e.immature)},n.prototype.getRecentTransactions=async function(){let t,e="";try{t=await this.node.info.wallet.getLast(this.node.info.wallet.account.name,5)}catch(t){return`<h2>${t}</h2>`}for(let o of t){o=await this.node.info.wallet.toDetails(o);const t=new Date(1e3*o.mtime).format("d-m-Y");let n=0,s=null;for(let t of o.inputs)t.path&&(n+=t.value,s="out"),0===o.time&&(s="out sending");if(n){n=0;for(let t of o.outputs)t.path||(n+=t.value,s="out")}else{for(let t of o.outputs)t.path&&(n+=t.value,s="in");0===o.time&&(s="in receiving"),o.tx.isCoinbase()&&(s="rig")}e+=`<holder><i class="glyph-icon flaticon-${s}"></i><span>`,e+=`<label>${t}</label><label>${i.wmcc(n,!0)} wmcc</label>`,e+=`<a><label class='r_goToExp' value="${o.hash}">Show Details</label></a></span></holder>`}return e||"<holder><h2>No recent transaction found.</h2></holder>"},n.prototype.getUnconfirmTxCount=function(){return this.node.mempool.getCount()},n.prototype.getUnconfirmTxSize=function(){return function(t){return t<1048576?(t/1024).toFixed(3):t<1073741824?(t/1024).toFixed(0):void 0}(this.node.mempool.getSize())},n.prototype.getLatestTxs=function(t,e){let o="";if(t){const e=[t.hash("hex"),t.getOutputValue()];if(!this._latesttxs.indexOf(e))return;this._latesttxs.push(e)}else this._latesttxs=[],this.node.mempool.map.forEach((t,e)=>{this._latesttxs.push([e,t.value])});const n=this._latesttxs.length,s=this._latesttxs.slice(Math.max(0,n-5),n);if(s.length){o+="<table>";for(let t=s.length-1;t>=0;t--)o+=`<tr><td><a title='${s[t][0]}' class='r_goToExp'>${s[t][0]}<a></td>`,o+=`<td>${i.wmcc(s[t][1],!0)}</td></tr>`;o+="</table>"}else o="<h2>No transaction in mempool.</h2>";return o},n.prototype.getCurrentBlock=async function(){let t="";const e=this.node.chain.height,o=this.node.chain.tip.rhash(),n=await this.node.chain.getEntry(e),s=await this.node.chain.getBlock(n.hash);return t+="<table>",t+=`<tr><td>Tip</td><td colspan='3'><a title='${o}'>${o}</a></td></tr>`,t+=`<tr><td>Hash</td><td colspan='3'><a title='${n.rhash()}' class='r_goToExp'>${n.rhash()}</a></td></tr>`,t+=`<tr><td>Height</td><td>${e}</td>`,t+=`<td>Age</td><td>${function(t,e){let o=e?t:Math.abs(Date.now()/1e3-t),n="",s={},r=0;const i={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(i).forEach(function(t){s[t]=Math.floor(o/i[t]),o-=s[t]*i[t],s[t]&&r<1&&(r++,n+=` ${s[t]} ${t}${s[t]>1?"s":""}`)}),`${n}${e?"":" ago"}`}(n.time)}</td></tr>`,t+=`<tr><td>Txns<a></td><td>${s.txs.length}</td>`,t+=`<td>Outputs</td><td>${i.wmcc(s.getClaimed())} wmcc</td></tr>`,t+=`<tr><td>Size</td><td>${s.getVirtualSize()/1e3} kb</td>`,t+=`<td>Weight</td><td>${s.getWeight()/1e3} kwu</td></tr>`},n.prototype.destroy=async function(){},n.prototype.getMinerInfo=function(t){this._getMinerInfo&&!t&&(t=this._getMinerInfo);let e="<table>";return t?(this._getMinerInfo=t,e+=`<tr><td>Address</td><td colspan="3"><a title='${t.address}' class='r_goToExp'>${t.address}</a></td></tr>`,e+=`<tr><td>Height</td><td>${t.height}</td><td>Fees</td><td>${i.wmcc(t.fees)} wmcc</td></tr>`,e+=`<tr><td>Transactions</td><td>${t.items.length+1}</td><td>Difficulty</td><td>${function(t){let e=t>>>24&255,o=65535/(16777215&t);for(;e<29;)o*=256,e++;for(;e>29;)o/=256,e--;return o.toFixed(12)}(t.bits)}</td></tr>`):e+=`<tr><td colspan="2" class="ellipse">Address: ${this.node.info.getAddress()}</td></tr>`,e+="<table>"},n.prototype.minerFoundBlock=function(t,e){if("object"!=typeof t)return;let o="";return o+='<table class=\'minerfound\'><tr><th rowspan="3"><i class="glyph-icon flaticon-remove"></i><i class="glyph-icon flaticon-rig"></i></th>',o+='<th colspan="2">Found New Block!</th></tr>',o+=`<tr><td>Block height</td><td>: ${e.height}</td></tr>`,o+=`<tr><td>Block reward</td><td>: ${i.wmcc(t.txs[0].outputs[0].value)} wmcc</td></tr></table>`},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);c("string"==typeof t),c(t.length>0),this.module=t,this.network="mainnet",this.prefix=h.join(g,`.${t}`),this.options=Object.create(null),this.data=Object.create(null),this.env=Object.create(null),this.args=Object.create(null),this.argv=[],this.pass=[],this.query=Object.create(null),this.hash=Object.create(null)}function s(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Argument #${t}`:t}function r(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t=t.replace(/\0/g,"")}function i(t){return/^[a-z0-9]+$/.test(t)}function l(t){return/^[a-zA-Z0-9]+$/.test(t)}function a(t){return!!l(t)&&!/[A-Z]/.test(t)}const c=o(1),h=o(13),u=o(8),p=o(0),{fs:f,util:d}=p.utils,g=u.homedir?u.homedir():"/";n.alias={seed:"seeds",node:"nodes",n:"network"},n.default={Options:{network:["mainnet","str",!1]},Node:{prefix:["~/.wmcc","str",!0],db:["leveldb","str",!1],"max-files":["512","uint",!0],"cache-size":["100","mb",!0]},Logger:{"log-level":["error","str",!0],"log-file":["true","bool",!0]},Chain:{prune:["false","bool",!1],"index-tx":["true","bool",!1],"index-address":["true","bool",!1]},Mempool:{"mempool-size":["100","mb",!0],"persistent-mempool":["false","bool",!1]},Pool:{listen:["true","bool",!1],"max-outbound":["32","uint",!0],"max-inbound":["128","uint",!0]},"Localhost (to listen on)":{host:["::","str",!0],port:["8880","uint",!0]},"Public Host (to advertise to peers)":{"public-host":["127.0.0.1","str",!0],"public-port":["8880","uint",!0]},"HTTP / RPC":{"http-host":["::","str",!0],"http-port":["7880","uint",!0],"api-key":["","str",!0],"no-auth":["false","bool",!0]},"Stratum Host (to listen to miners)":{"stratum-host":["0.0.0.0","str",!0],"stratum-port":["6880","uint",!0],"stratum-public-host":["127.0.0.1","str",!0],"stratum-public-port":["6880","uint",!0],"stratum-max-inbound":["50","uint",!0],"stratum-notify-interval":["60","uint",!0],"stratum-difficulty":["1","uint",!0]},Miner:{"coinbase-flags":["mined by wmcc_user","str",!0,"r_maxsize"],"coinbase-address":["","str",!0,"r_checkAddress extrawidth"]},Wallet:{"wallet-witness":["true","bool",!0]}},n.prototype.getDefault=function(){return n.default},n.prototype.inject=function(t){for(const e of Object.keys(t)){const o=t[e];switch(e){case"hash":case"query":case"env":case"argv":case"config":continue}this.set(e,o)}},n.prototype.load=function(t){t.hash&&this.parseHash(t.hash),t.query&&this.parseQuery(t.query),t.env&&this.parseEnv(t.env),t.argv&&this.parseArg(t.argv),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.open=function(t){if(f.unsupported)return;const e=this.getFile(t);let o;try{o=f.readFileSync(e,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseConfig(o),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.set=function(t,e){c("string"==typeof t,"Key must be a string."),null!=e&&(t=(t=t.replace(/-/g,"")).toLowerCase(),this.options[t]=e)},n.prototype.has=function(t){return"number"==typeof t?(c(t>=0,"Index must be positive."),!(t>=this.argv.length)):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]||(null!=this.query[t]||(null!=this.args[t]||(null!=this.env[t]||(null!=this.data[t]||null!=this.options[t])))))},n.prototype.get=function(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const o=t;for(const t of o){const e=this.get(t);if(null!==e)return e}return e}return"number"==typeof t?(c(t>=0,"Index must be positive."),t>=this.argv.length?e:null!=this.argv[t]?this.argv[t]:e):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]?this.hash[t]:null!=this.query[t]?this.query[t]:null!=this.args[t]?this.args[t]:null!=this.env[t]?this.env[t]:null!=this.data[t]?this.data[t]:null!=this.options[t]?this.options[t]:e)},n.prototype.typeOf=function(t){const e=this.get(t);return null===e?"null":typeof e},n.prototype.str=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o)throw new Error(`${s(t)} must be a string.`);return o},n.prototype.int=function(t,e){let o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if("number"!=typeof o)throw new Error(`${s(t)} must be an int.`);if(!Number.isSafeInteger(o))throw new Error(`${s(t)} must be an int.`);return o}if(!/^\-?\d+$/.test(o))throw new Error(`${s(t)} must be an int.`);if(o=parseInt(o,10),!Number.isSafeInteger(o))throw new Error(`${s(t)} must be an int.`);return o},n.prototype.uint=function(t,e){const o=this.int(t);if(void 0===e&&(e=null),null===o)return e;if(o<0)throw new Error(`${s(t)} must be a uint.`);return o},n.prototype.float=function(t,e){let o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if("number"!=typeof o)throw new Error(`${s(t)} must be a float.`);if(!isFinite(o))throw new Error(`${s(t)} must be a float.`);return o}if(!/^\-?\d*(?:\.\d*)?$/.test(o))throw new Error(`${s(t)} must be a float.`);if(!/\d/.test(o))throw new Error(`${s(t)} must be a float.`);if(o=parseFloat(o),!isFinite(o))throw new Error(`${s(t)} must be a float.`);return o},n.prototype.ufloat=function(t,e){const o=this.float(t);if(void 0===e&&(e=null),null===o)return e;if(o<0)throw new Error(`${s(t)} must be a positive float.`);return o},n.prototype.fixed=function(t,e,o){const n=this.float(t);if(void 0===o&&(o=null),null===n)return o;try{return d.fromFloat(n,e||0)}catch(e){throw new Error(`${s(t)} must be a fixed number.`)}},n.prototype.ufixed=function(t,e,o){const n=this.fixed(t,e);if(void 0===o&&(o=null),null===n)return o;if(n<0)throw new Error(`${s(t)} must be a positive fixed number.`);return n},n.prototype.bool=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("number"==typeof o){if(1===o)return!0;if(0===o)return!1}if("string"!=typeof o){if("boolean"!=typeof o)throw new Error(`${s(t)} must be a boolean.`);return o}if("true"===o||"1"===o)return!0;if("false"===o||"0"===o)return!1;throw new Error(`${s(t)} must be a boolean.`)},n.prototype.buf=function(t,e,o){const n=this.get(t);if(o||(o="hex"),void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if(!Buffer.isBuffer(n))throw new Error(`${s(t)} must be a buffer.`);return n}const r=Buffer.from(n,o);if(r.length!==Buffer.byteLength(n,o))throw new Error(`${s(t)} must be a ${o} string.`);return r},n.prototype.array=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if(!Array.isArray(o))throw new Error(`${s(t)} must be an array.`);return o}const n=o.trim().split(/\s*,\s*/),r=[];for(const t of n)0!==t.length&&r.push(t);return r},n.prototype.obj=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("object"!=typeof o)throw new Error(`${s(t)} must be an object.`);return o},n.prototype.func=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("function"!=typeof o)throw new Error(`${s(t)} must be a function.`);return o},n.prototype.path=function(t,e){let o=this.str(t);if(void 0===e&&(e=null),null===o)return e;switch(o[0]){case"~":o=h.join(g,o.substring(1));break;case"@":o=h.join(this.prefix,o.substring(1))}return h.normalize(o)},n.prototype.mb=function(t,e){const o=this.uint(t);return void 0===e&&(e=null),null===o?e:1024*o*1024},n.prototype.getNetwork=function(){let t=this.str("network");return t||(t="mainnet"),c(i(t),"Bad network."),t},n.prototype.getPrefix=function(){let t=this.str("prefix");if(t)return"~"===t[0]&&(t=h.join(g,t.substring(1))),t;t=h.join(g,`.${this.module}`);const e=this.str("network");return e&&(c(i(e),"Bad network."),"mainnet"!==e&&(t=h.join(t,e))),h.normalize(t)},n.prototype.getFile=function(t){const e=this.str("config");return e||h.join(this.prefix,t)},n.prototype.ensure=function(){return f.unsupported?Promise.resolve():f.mkdirp(this.prefix)},n.prototype.location=function(t){return h.join(this.prefix,t)},n.prototype.write=function(t,e){f.writeFileSync(this.location(t),e)},n.prototype.parseConfig=function(t){c("string"==typeof t,"Config must be text."),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\\\n/g,"");let e=!0,o=!1,s=0;for(const r of t.split("\n")){const t=r.trim();if(s+=1,0===t.length)continue;if("#"===t[0])continue;const i=t.indexOf("="),l=t.indexOf(":");let c=-1;if(-1!==l&&(l<i||-1===i)){if(o&&!e)throw new Error(`Expected '=' on line ${s}: "${t}".`);c=l,o=!0,e=!0}else{if(-1===i){const o=e?":":"=";throw new Error(`Expected '${o}' on line ${s}: "${t}".`)}if(o&&e)throw new Error(`Expected ':' on line ${s}: "${t}".`);c=i,o=!0,e=!1}let h=t.substring(0,c).trim();if(h=h.replace(/\-/g,""),!a(h))throw new Error(`Invalid option on line ${s}: ${h}.`);const u=t.substring(c+1).trim();if(0===u.length)continue;const p=n.alias[h];p&&(h=p),this.data[h]=u}},n.prototype.parseArg=function(t){t&&"object"==typeof t||(t=process.argv),c(Array.isArray(t));let e=null,o=!1;for(let s=2;s<t.length;s++){const r=t[s];if(c("string"==typeof r),"--"===r){o=!0;continue}if(o){this.pass.push(r);continue}if(0===r.length){e=null;continue}if(0===r.indexOf("--")){const t=r.indexOf("=");let o=null,s=null,i=!1;if(-1!==t?(o=r.substring(2,t),s=r.substring(t+1),e=null,i=!1):(o=r.substring(2),s="true",e=null,i=!0),o=o.replace(/\-/g,""),!a(o))throw new Error(`Invalid argument: --${o}.`);if(0===s.length)continue;if(o.length>1){const t=n.alias[o];t&&(o=t)}this.args[o]=s,i&&(e=o);continue}if("-"===r[0]){e=null;for(let t=1;t<r.length;t++){let o=r[t];if((o<"a"||o>"z")&&(o<"A"||o>"Z")&&(o<"0"||o>"9")&&"?"!==o)throw new Error(`Invalid argument: -${o}.`);const s=n.alias[o];s&&(o=s),this.args[o]="true",e=o}continue}const i=r;0!==i.length?e?(this.args[e]=i,e=null):this.argv.push(i):e=null}},n.prototype.parseEnv=function(t){let e=this.module;e=(e=e.toUpperCase()).replace(/-/g,"_"),e+="_",t&&"object"==typeof t||(t=process.env),c(t&&"object"==typeof t);for(let o of Object.keys(t)){const s=t[o];if(c("string"==typeof s),d.startsWith(o,e)&&(o=o.substring(e.length),o=o.replace(/_/g,""),function(t){return!!l(t)&&!/[a-z]/.test(t)}(o)&&0!==s.length)){if((o=o.toLowerCase()).length>1){const t=n.alias[o];t&&(o=t)}this.env[o]=s}}},n.prototype.parseQuery=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.search))return{}}return this.parseForm(t,this.query)},n.prototype.parseHash=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.hash))return{}}return this.parseForm(t,this.hash)},n.prototype.parseForm=function(t,e){if(c("string"==typeof t),0===t.length)return;let o="?";e===this.hash&&(o="#"),t[0]===o&&(t=t.substring(1));for(const o of t.split("&")){const t=o.indexOf("=");let s,i;if(-1!==t?(s=o.substring(0,t),i=o.substring(t+1)):(s=o,i="true"),s=r(s),s=s.replace(/\-/g,""),!a(s))continue;if(0===(i=r(i)).length)continue;const l=n.alias[s];l&&(s=l),e[s]=i}},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);i.call(this),this.config=new p("wmcc"),this.config.inject(t),this.config.load(t),t.config&&this.config.open("wmcc.conf"),this.network=a.get(this.config.network),this.startTime=-1,this.bound=[],this.plugins=Object.create(null),this.stack=[],this.logger=null,this.workers=null,this.spv=!1,this.chain=null,this.fees=null,this.mempool=null,this.pool=null,this.miner=null,this.http=null,this.wallet=null,this.stratum=null,this.init()}const s=o(1),r=o(0),{AsyncObject:i,util:l}=r.utils,{Network:a}=r.protocol,{WorkerPool:c}=r.workers,{secp256k1:h}=r.crypto,u=r.native,p=o(3),f=o(5);Object.setPrototypeOf(n.prototype,i.prototype),n.prototype.initOptions=function(){let t=new f;const e=this.config;e.has("logger")&&(t=e.obj("logger")),t.set({filename:e.bool("log-file")?e.location("debug.log"):null,level:e.str("log-level"),console:e.bool("log-console"),browser:e.bool("log-browser"),shrink:e.bool("log-shrink")}),this.logger=t.context("node"),this.workers=new c({enabled:e.bool("workers"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout"),file:e.str("worker-file")})},n.prototype.init=function(){this.initOptions(),this.on("error",()=>{}),this.workers.on("spawn",t=>{this.logger.info("Spawning worker process: %d.",t.id)}),this.workers.on("exit",(t,e)=>{this.logger.warning("Worker %d exited: %s.",e.id,t)}),this.workers.on("log",(t,e)=>{this.logger.debug("Worker %d says:",e.id),this.logger.debug(t)}),this.workers.on("error",(t,e)=>{e?this.logger.error("Worker %d error: %s",e.id,t.message):this.emit("error",t)}),this.hook("preopen",()=>this.handlePreopen()),this.hook("preclose",()=>this.handlePreclose()),this.hook("open",()=>this.handleOpen()),this.hook("close",()=>this.handleClose())},n.prototype.ensure=function(){return this.config.ensure()},n.prototype.location=function(t){return this.config.location(t)},n.prototype.handlePreopen=async function(){await this.logger.open(),await this.workers.open(),this.bind(this.network.time,"offset",t=>{this.logger.info("Time offset: %d (%d minutes).",t,t/60|0)}),this.bind(this.network.time,"sample",(t,e)=>{this.logger.debug("Added time data: samples=%d, offset=%d (%d minutes).",e,t,t/60|0)}),this.bind(this.network.time,"mismatch",()=>{this.logger.warning("Adjusted time mismatch!"),this.logger.warning("Please make sure your system clock is correct!")})},n.prototype.handleOpen=async function(){this.startTime=l.now(),h.binding||(this.logger.warning("Warning: secp256k1-node was not built."),this.logger.warning("Verification will be slow.")),u.binding||(this.logger.warning("Warning: wmcc-native was not built."),this.logger.warning("Hashing will be slow.")),this.workers.enabled||(this.logger.warning("Warning: worker pool is disabled."),this.logger.warning("Verification will be slow."))},n.prototype.handlePreclose=async function(){},n.prototype.handleClose=async function(){for(const[t,e,o]of this.bound)t.removeListener(e,o);this.bound.length=0,this.startTime=-1,await this.workers.close(),await this.logger.close()},n.prototype.bind=function(t,e,o){this.bound.push([t,e,o]),t.on(e,o)},n.prototype.error=function(t){this.logger.error(t),this.emit("error",t)},n.prototype.uptime=function(){return-1===this.startTime?0:l.now()-this.startTime},n.prototype.use=function(t){s(t,"Plugin must be an object."),s("function"==typeof t.init,"`init` must be a function."),s(!this.loaded,"Cannot add plugin after node is loaded.");const e=t.init(this);if(s(!e.open||"function"==typeof e.open,"`open` must be a function."),s(!e.close||"function"==typeof e.close,"`close` must be a function."),t.id){switch(s("string"==typeof t.id,"`id` must be a string."),t.id){case"chain":case"fees":case"mempool":case"miner":case"pool":case"rpc":case"http":case"wallet":case"stratum":s(!1,`${t.id} is already added.`)}s(!this.plugins[t.id],`${t.id} is already added.`),this.plugins[t.id]=e}return this.stack.push(e),"function"==typeof e.on&&e.on("error",t=>this.error(t)),e},n.prototype.has=function(t){return null!=this.plugins[t]},n.prototype.get=function(t){switch(s("string"==typeof t,"Plugin name must be a string."),t){case"chain":return s(this.chain,"chain is not loaded."),this.chain;case"fees":return s(this.fees,"fees is not loaded."),this.fees;case"mempool":return s(this.mempool,"mempool is not loaded."),this.mempool;case"miner":return s(this.miner,"miner is not loaded."),this.miner;case"pool":return s(this.pool,"pool is not loaded."),this.pool;case"rpc":return s(this.rpc,"rpc is not loaded."),this.rpc;case"http":return s(this.http,"http is not loaded."),this.http;case"wallet":return s(this.wallet,"wallet is not loaded."),this.wallet;case"stratum":return s(this.stratum,"stratum is not loaded."),this.stratum}return this.plugins[t]||null},n.prototype.require=function(t){const e=this.get(t);return s(e,`${t} is not loaded.`),e},n.prototype.loadPlugins=function(){const t=this.config.array("plugins",[]),e=this.config.func("loader");for(let o of t)"string"==typeof o&&(s(e,"Must pass a loader function."),o=e(o)),this.use(o)},n.prototype.openPlugins=async function(){for(const t of this.stack)t.open&&await t.open()},n.prototype.closePlugins=async function(){for(const t of this.stack)t.close&&await t.close()},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.level=n.levels.NONE,this.colors=n.HAS_TTY,this.console=!0,this.browser=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),this.locker=new u,t&&this.set(t)}function s(t,e){if(!(this instanceof s))return new s(t,e);i("string"==typeof e),this.logger=t,this.module=e}function r(t){return new Promise((e,o)=>{const n=a.createWriteStream(t,{flags:"a"}),s=()=>{n.removeListener("error",r),n.removeListener("open",i)},r=t=>{try{n.close()}catch(t){}s(),o(t)},i=()=>{s(),e(n)};n.once("error",r),n.once("open",i)})}const i=o(1),l=o(0),{fs:a,util:c,co:h,Lock:u}=l.utils;n.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),n.MAX_FILE_SIZE=20<<20,n.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},n.levelsByVal=["none","error","warning","info","debug","spam"],n.prefixByVal=["N","E","W","I","D","S"],n.styles=["0","1;31","1;33","94","90","90"],n.prototype.set=function(t){i(t),i(this.closed),"string"!=typeof t?(null!=t.level&&(i("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&n.HAS_TTY&&(i("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(i("boolean"==typeof t.console),this.console=t.console),null!=t.browser&&(i("boolean"==typeof t.browser),this.browser=t.browser),null!=t.shrink&&(i("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(i("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)},n.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},n.prototype._open=async function(){this.filename?this.stream?this.closed=!1:a.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await r(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1},n.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},n.prototype._close=async function(){if(null!=this.timer&&(h.clearTimeout(this.timer),this.timer=null),a.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await function(t){return new Promise((e,o)=>{const n=()=>{t.removeListener("error",s),t.removeListener("close",r)},s=t=>{n(),o(t)},r=()=>{n(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",s),t.once("close",r),t.close()})}(this.stream)}finally{this.closing=!1}this.stream=null}this.closed=!0},n.prototype.truncate=async function(){if(!this.filename)return;if(a.unsupported)return;i(!this.stream);let t;try{t=await a.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const e=n.MAX_FILE_SIZE;if(t.size<=e+e/10)return;this.debug("Truncating log file to %d bytes.",e);const o=await a.open(this.filename,"r+"),s=Buffer.allocUnsafe(e);await a.read(o,s,0,e,t.size-e),await a.ftruncate(o,e),await a.write(o,s,0,e,0),await a.close(o)},n.prototype.handleError=function(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()},n.prototype.reopen=async function(){const t=await this.locker.lock();try{return await this._reopen()}finally{t()}},n.prototype._reopen=async function(){if(!this.stream&&!this.closed&&!a.unsupported){try{this.stream=await r(this.filename)}catch(t){return void this.retry()}this.stream.once("error",this.handleError.bind(this))}},n.prototype.retry=function(){i(null==this.timer),this.timer=h.setTimeout(()=>{this.timer=null,this.reopen()},1e4,this)},n.prototype.setFile=function(t){i("string"==typeof t),i(!this.stream,"Log stream has already been created."),this.filename=t},n.prototype.setLevel=function(t){const e=n.levels[t.toUpperCase()];i(null!=e,"Invalid log level."),this.level=e},n.prototype.error=function(...t){if(this.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,null,e):this.log(n.levels.ERROR,null,t)},n.prototype.warning=function(...t){if(this.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,null,e):this.log(n.levels.WARNING,null,t)},n.prototype.info=function(...t){if(this.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,null,e):this.log(n.levels.INFO,null,t)},n.prototype.debug=function(...t){if(this.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,null,e):this.log(n.levels.DEBUG,null,t)},n.prototype.spam=function(...t){if(this.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,null,e):this.log(n.levels.SPAM,null,t)},n.prototype.log=function(t,e,o){this.closed||this.level<t||(this.writeConsole(t,e,o),this.writeBrowser(t,e,o),this.writeStream(t,e,o))},n.prototype.context=function(t){let e=this.contexts[t];return e||(e=new s(this,t),this.contexts[t]=e),e},n.prototype.writeConsole=function(t,e,o){const s=n.levelsByVal[t];if(i(s,"Invalid log level."),!this.console)return!1;if(!process.stdout){let r=`[${s}] `;return e&&(r+=`(${e}) `),"object"==typeof o[0]?t===n.levels.ERROR?console.error(r,o[0]):console.log(r,o[0]):(r+=c.format(o,!1),t===n.levels.ERROR?(console.error(r),!0):(console.log(r),!0))}let r;if(this.colors){const e=n.styles[t];i(e),r=`[${e}m[${s}][m `}else r=`[${s}] `;return e&&(r+=`(${e}) `),r+=c.format(o,this.colors),r+="\n",t===n.levels.ERROR?process.stderr.write(r):process.stdout.write(r)},n.prototype.writeBrowser=function(t,e,o){const s=n.levelsByVal[t];if(i(s,"Invalid log level."),!this.browser)return!1;let r=`[${s}] `;return e&&(r+=`(${e}) `),"object"==typeof o[0]?t===n.levels.ERROR?console.error(r,o[0]):console.log(r,o[0]):(r+=c.format(o,!1),t===n.levels.ERROR?(console.error(r),!0):("net"!==e&&console.log(r),!0))},n.prototype.writeStream=function(t,e,o){const s=n.prefixByVal[t];if(i(s,"Invalid log level."),!this.stream)return;if(this.closing)return;let r=`[${s}:${c.date()}] `;e&&(r+=`(${e}) `),r+=c.format(o,!1),r+="\n",this.stream.write(r)},n.prototype.logError=function(t,e,o){if(this.closed)return;a.unsupported&&this.console&&t<=n.levels.WARNING&&console.error(o);let s=String(o.message).replace(/^ *Error: */,"");t!==n.levels.ERROR&&(s=`Error: ${s}`),this.log(t,e,[s]),t<=n.levels.WARNING&&this.stream&&this.stream.write(o.stack+"\n")},n.prototype.memory=function(t){const e=c.memoryUsage();this.log(n.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])},s.prototype.open=function(){return this.logger.open()},s.prototype.close=function(){return this.logger.close()},s.prototype.setFile=function(t){this.logger.setFile(t)},s.prototype.setLevel=function(t){this.logger.setLevel(t)},s.prototype.error=function(...t){if(this.logger.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,e):this.log(n.levels.ERROR,t)},s.prototype.warning=function(...t){if(this.logger.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,e):this.log(n.levels.WARNING,t)},s.prototype.info=function(...t){if(this.logger.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,e):this.log(n.levels.INFO,t)},s.prototype.debug=function(...t){if(this.logger.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,e):this.log(n.levels.DEBUG,t)},s.prototype.spam=function(...t){if(this.logger.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,e):this.log(n.levels.SPAM,t)},s.prototype.log=function(t,e){this.logger.log(t,this.module,e)},s.prototype.context=function(t){return new s(this.logger,t)},s.prototype.logError=function(t,e){this.logger.logError(t,this.module,e)},s.prototype.memory=function(){this.logger.memory(this.module)},n.global=new n,t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);r.call(this),this.node=t,this.network=t.network,this.filter=null,this.listen=!1,this._init()}const s=o(0),{AsyncObject:r}=s.utils;Object.setPrototypeOf(n.prototype,r.prototype),n.prototype._init=function(){this.node.on("connect",(t,e)=>{this.listen&&this.emit("block connect",t,e.txs)}),this.node.on("disconnect",(t,e)=>{this.listen&&this.emit("block disconnect",t)}),this.node.on("tx",t=>{this.listen&&this.emit("tx",t)}),this.node.on("reset",t=>{this.listen&&this.emit("chain reset",t)})},n.prototype._open=function(t){return this.listen=!0,Promise.resolve()},n.prototype._close=function(){return this.listen=!1,Promise.resolve()},n.prototype.getTip=function(){return Promise.resolve(this.node.chain.tip)},n.prototype.getEntry=async function(t){const e=await this.node.chain.getEntry(t);return e&&await this.node.chain.isMainChain(e)?e:null},n.prototype.send=function(t){return this.node.relay(t),Promise.resolve()},n.prototype.setFilter=function(t){return this.filter=t,this.node.pool.setFilter(t),Promise.resolve()},n.prototype.addFilter=function(t){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.resetFilter=function(){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.estimateFee=async function(t){return this.node.fees?this.node.fees.estimateFee(t):this.network.feeRate},n.prototype.rescan=function(t){return this.node.chain.scan(t,this.filter,(t,e)=>this.fire("block rescan",t,e))},t.exports=n},function(module,exports,__webpack_require__){"use strict";function Info(t){if(!(this instanceof Info))return new Info(t);this.info=null,this.node=t,this.wallet=t.wallet||null,this.account=t.wallet?t.wallet.account:null,this.explorer={isHome:!0}}function toDifficulty(t){let e=t>>>24&255,o=65535/(16777215&t);for(;e<29;)o*=256,e++;for(;e>29;)o/=256,e--;return o.toFixed(12)}function substract(t,e,o=8){const n=Math.pow(10,o);return(t*n-e*n).toFixed(0)/n}function sum(t,e,o=8){const n=Math.pow(10,o);return(t*n+e*n).toFixed(0)/n}function compare(t,e){const o=t.time?t.time:t.mtime,n=e.time?e.time:e.mtime;return o<n?1:n<o?-1:0}function toTxTable(t,e){let o="",n=!1;if(Object.keys(t.input).length)for(let s in t.input)s===e?(o+=`<div><span>${s}</span>`,n=!0):t.pending.includes(s)?o+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i>\n          <span class='red address r_goToExp' title='Output from unconfirmed transaction'>${s}</span>`:o+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${s}</span>`,o+=`<span class='value'>${Amount.wmcc(t.input[s],!0)} wmcc</span></div>`;else o+="<div><span class='coinbase'>No Inputs (Newly Generated Coins)</span></div>";o+=`</td><td><i class="glyph-icon flaticon-${n?"out red":"in green"}"></i></td><td>`;for(let n in t.output)o+="<div>",o+="unknown"===n?"<a class='unparsed'>Unparsed output address</a>":n===e?`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span>${n}</span>`:`<i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${n}</span>`,o+=`<span class='value'>${Amount.wmcc(t.output[n],!0)} wmcc</span></div>`;return o}function page(t,e,o,n){let s="";const r=e-o,i=e+o,l=parseInt(e/o+1),a=Math.ceil(t/o),{start:c,end:h}=median(l,a,10);s+=`<div class="page"><a ${0===e?'class="disable"':'class="'+n+'" offset="'+r+'" limit="'+o+'"'}>&#9668;</a>`;for(let t=c;t<h;t++)s+=`<a ${l===t+1?'class="active"':'class="'+n+'" offset="'+o*t+'" limit="'+o+'"'}>${t+1}</a>`;return s+=`<a ${i+1>t?'class="disable"':'class="'+n+'" offset="'+i+'" limit="'+o+'"'}>&#9658;</a></div>`}function age(t,e){let o=e?t:Math.abs(Date.now()/1e3-t),n="",s={},r=0;const i={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(i).forEach(function(t){s[t]=Math.floor(o/i[t]),o-=s[t]*i[t],s[t]&&r<2&&(r++,n+=` ${s[t]} ${t}${s[t]>1?"s":""}`)}),`${n}${e?"":" ago"}`}function filtermeta(t){return t.filter(function(t,e,o){return o[e].tx._hhash!==t.tx._hhash})}function filtermeta(t){let e=[];return t.filter(function(t){return-1===e.indexOf(t.tx._hhash)&&(e.push(t.tx._hhash),!0)})}function median(t,e,o){let n=Math.max(0,t-o/2);const s=Math.min(n+o,e);return n=Math.max(0,Math.min(s-o,s)),{start:n,end:s}}const Core=__webpack_require__(0),{Address:Address}=Core.primitives,{Account:Account}=Core.wallet,{Amount:Amount}=Core.wmcc,{encoding:encoding,util:util}=Core.utils,{consensus:consensus,policy:policy}=Core.protocol;Info.prototype.getWalletID=function(){return this.wallet.id},Info.prototype.getAccounts=function(){return this.wallet.getAccounts()},Info.prototype.getAccount=function(){return this.wallet.account},Info.prototype.getAccountName=function(){return this.wallet.account.name},Info.prototype.getTempReceive=function(){return this.wallet.getTempReceive().toString()},Info.prototype.createReceive=async function(){const t=await this.getAccountName();await this.wallet.createReceive(t);return this.getTempReceive()},Info.prototype.estimateFee=async function(){let t=await this.node.walletdb.estimateFee();return Amount.wmcc(t)},Info.prototype.estimatePri=async function(){let t=await this.node.fees.estimatePriority();return 0===t&&(t=this.node.fees.minTrackedPri),Amount.wmcc(t)},Info.prototype.isMinerStarted=function(){return this.node.miner.cpu.running},Info.prototype.startMining=async function(){try{return await this.node.miner.cpu.start()}catch(t){}},Info.prototype.stopMining=async function(){try{return await this.node.miner.cpu.stop()}catch(t){this.node.miner.reset(!1)}},Info.prototype.getAddress=function(){return this.node.miner.getAddress().toString()},Info.prototype.getWalletInfo=async function(){let t="";const e=this.wallet.toJSON(!0);return t+=`<holder><i class="glyph-icon flaticon-wallets"></i><span>${e.id} <a>Wallet Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-id"></i><span>${e.wid} <a>Wallet ID</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account"></i><span>${e.account.name} <a>Account Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account-lock"></i><span>${e.account.type.toUpperCase()} <a>Account Type</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-swap"></i><span>${e.state.tx} <a>Number of Transactions</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-network"></i><span>${e.network.toUpperCase()} <a>Network</a></span></holder>`},Info.prototype.getWalletDetails=async function(){let t="<table>";const e=this.wallet.toJSON(!0),o=e.account.accountKey,{tx:n,coin:s,confirmed:r,unconfirmed:i}=e.state;return t+=`<tr><td>Wallet Name</td><td colspan="2">${e.id}</td></tr>`,t+=`<tr><td>Wallet ID</td><td colspan="2">${e.wid}</td></tr>`,t+=`<tr><td>Wallet Key</td><td>${e.chksum.toString("hex")}★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-copy" title="Copy"></i></td></tr>',t+=`<tr><td>Token</td><td title="${e.token}">${e.token.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${e.token}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Name</td><td colspan="2">${e.account.name}</td></tr>`,t+=`<tr><td>Account Public Key</td><td title="${o}">${o.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${o}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Type</td><td colspan="2">${e.account.type.toUpperCase()}</td></tr>`,t+=`<tr><td>Number of Transactions</td><td colspan="2">${n}</td></tr>`,t+=`<tr><td>Number of Coins</td><td colspan="2">${s}</td></tr>`,t+=`<tr><td>Confirm Balance</td><td colspan="2">${Amount.wmcc(r,!0)} wmcc</td></tr>`,t+=`<tr><td>Unconfirm Balance</td><td colspan="2">${Amount.wmcc(i,!0)} wmcc</td></tr>`,t+=`<tr><td>Network</td><td colspan="2">${e.network.toUpperCase()}</td></tr>`,t+=`<tr><td>Watch Only</td><td colspan="2">${e.watchOnly.toString().toUpperCase()}</td></tr>`,t+="</table>"},Info.prototype.getWalletHistory=async function(t,e){t=parseInt(t)||10,e=parseInt(e)||0;const o=await this.wallet.getTransactions(this.wallet.account.name,t,e);return await this.getWalletHistoryTable(o,{limit:t,offset:e})},Info.prototype.getWalletHistoryTable=async function(t,e){if(0===t.length)return`<h2>No transactions found in wallet <span>${this.wallet.id}</span> for account <span>${this.wallet.account.name}.</span></h2>`;let o="<table><tr><th>Date/Time</th><th>Status</th><th>Height</th><th>Transactions Hash</th><th>Value</th></tr>";for(let n=0;n<t.length;n++){const s=new Date(1e3*t[n].mtime).format("M j, Y, g:i a");let r;let i=0,l=!1;if(t[n].inputs[0].address)for(let e=0;e<t[n].inputs.length;e++)t[n].inputs[e].path&&(i+=t[n].inputs[e].value,l=!0,r="Sent",0===t[n].time&&(r="Sending"));for(let o=0;o<t[n].outputs.length;o++)if(t[n].outputs[o].path){if(l?i-=t[n].outputs[o].value:i+=t[n].outputs[o].value,r)continue;r="Received",0===t[n].time&&(r="Receiving"),t[n].tx.isCoinbase()&&(r=e.pending?"Staled":"Mined")}let a=0;try{a=Amount.wmcc(i)}catch(e){console.log(e),console.log(t[n]),console.log(i),a="unknown"}o+="<tr>",o+=`<td>${s}</td>`,o+=`<td>${r}</td>`,t[n].block?o+=`<td title="${util.revHex(t[n].block)}"><a class='r_goToExp'>${t[n].height}</a></td>`:o+="<td>N/A</td>",o+=`<td title="${t[n].hash}"><a class='r_goToExp'>${t[n].hash}</a></td>`,o+=`<td>${a}</td>`,o+="</tr>"}if(o+="</table>",!e.limit)return o;const n=await this.wallet.getPending(this.wallet.account.name);return o+=page(await this.wallet.getTotal(this.wallet.account.name)-n.length,e.offset,e.limit,"r_walletGetHistory")},Info.prototype.getWalletPendingTx=async function(){const t=await this.wallet.getPendingDetails(this.wallet.account.name);return await this.getWalletHistoryTable(t,{pending:!0})},Info.prototype.setGenSearchAddress=async function(t){let e="",o=null;try{o=Address.fromString(t)}catch(o){return e+='<div class="error"><h2>Opps! Invalid address format</h2><span>',e+=`<a>${t}</a> is not a valid WMCC Address.<br>Please check and try again.</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>'}if(!await this.wallet.getPath(o))return e+='<div class="error"><h2>Opps! Address not found</h2><span>Cannot find <a>',e+=`${t}</a> in this wallet (<a>${this.wallet.id}</a>).</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>';await this.setExpAddress(t);const{metatx:n,coins:s}=this.explorer.details;let r=0;for(let t of s)r+=t.value;let i=0;for(let t of n)for(let e of t.tx.outputs){let t=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);o.hash.equals(t)&&(i+=e.value)}const l=$('<div id="qrcode"></div>').qrcode(o.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png"),a=n.length?`<i class="glyph-icon flaticon-record r_goToExp" value=${t} title="View Transactions"></i>`:"";return e+=`<div class="address"><img src="${l}"/><h2>Your WMCC Address</h2><table>`,e+=`<tr><td>Number of Transactions</td><td><span>${n.length}${a}</span></td></tr>`,e+=`<tr><td>Total Received</td><td><span>${Amount.wmcc(i,!0)} wmcc</span></td></tr>`,e+=`<tr><td>Address Hash 160</td><td><span class='address'>${o.hash.toString("hex")}</span></td></tr>`,e+=`<tr><td>Final Balance</td><td><span>${Amount.wmcc(r,!0)} wmcc</span></td></tr>`,e+="</table>",e+=`<p><a>This is Your WMCC Address.</a><a class="address">${t}</a>`,e+="<a>Share this with anyone so they can send you wmcoins.</a>",e+='<submit class="button r_genGotoAddresses">BACK</submit></p></div>'},Info.prototype.getGenAddress=async function(t=10,e=0){t=parseInt(t)||10,e=parseInt(e)||0;let o="<table><tr><th>Type</th><th>Address</th><th>Hash 160</th><th></th></tr>";const n=await this.wallet.getAccountPaths(this.wallet.account.name),s=t+e>n.length?n.length:e+t;for(let t=e;t<s;t++){const e=n[t].toAddress();o+=`<tr><td>${e.getType()}</td><td><a class='r_genGotoAddress' title='${e}'>${e}</a></td>`,o+=`<td><a title='${n[t].hash}'>${n[t].hash}</a></td>`,o+=`<td><i class="glyph-icon flaticon-copy r_genCopyAddress" value="${e}" title="Copy to clipboard"></i>`,o+='<i class="glyph-icon flaticon-gear r_walletManageAddress" title="Manage address"></i></td></tr>'}o+="</table>";return o+=page(n.length,e,t,"r_genGotoAddresses")},Info.prototype.getExpLatestBlocks=async function(t=5){if(!this.explorer.isHome)return"";const e=this.node.chain.height,o=parseInt(t);let n="<h1>Latest Blocks</h1><table class='home'><tr><th>Height</th><th>Age</th><th>Transactions</th><th>Total Output (wmcc)</th><th>Size (kb)</th><th>Weight (kwu)</th></tr>";for(let t=e;t>e-o&&t>-1;t--){const e=await this.node.chain.getEntry(t),o=await this.node.chain.getBlock(e.hash);n+=`<tr><td class='block r_goToExp'>${e.height}</td>`,n+=`<td>${age(e.time)}</td>`,n+=`<td>${o.txs.length}</td>`,n+=`<td>${Amount.wmcc(o.getClaimed())}</td>`,n+=`<td>${o.getVirtualSize()/1e3}</td>`,n+=`<td>${o.getWeight()/1e3}</td></tr>`}return n+="</table>"},Info.prototype.getExpLatestTransaction=async function(t=10){if(!this.explorer.isHome)return"";let e="<h1>Latest Transactions</h1>";if(!this.node.mempool.map.size)return e+'<h2 class="empty">No latest transaction found.</h2>';const o=parseInt(t);let n=0;return e+="<table class='home'><tr><th>Transaction Hash</th><th>Size (bytes)</th><th>Value (wmcc)</th></tr>",this.node.mempool.map.forEach((t,s)=>{o>n&&(e+=`<tr><td class='tx r_goToExp'>${s}</td>`,e+=`<td>${t.size}</td>`,e+=`<td>${Amount.wmcc(t.value,!0)}</td></tr>`,n++)}),e+="</table>"},Info.prototype.setExpBlockByHeight=async function(t){try{const e=parseInt(t,10),o=await this.node.chain.getEntry(e),n=await this.node.chain.getBlock(o.hash);return this.explorer.details={entry:o,block:n},o.height||!1}catch(t){return!1}},Info.prototype.setExpBlockByHash=async function(t){try{const e=await this.node.chain.getEntry(util.revHex(t)),o=await this.node.chain.getBlock(util.revHex(t));return this.explorer.details={entry:e,block:o},e.rhash()||!1}catch(t){return!1}},Info.prototype.getExpBlockByHeight=function(t){const{entry:e}=this.explorer.details;return e?e.height:this.setExpBlockByHeight(t||this.node.chain.tip.height)},Info.prototype.getExpHash=function(){return this.explorer.details.entry.rhash()},Info.prototype.getExpPrevHash=function(){const{entry:t}=this.explorer.details;return t.prevBlock!==encoding.NULL_HASH?util.revHex(t.prevBlock):null},Info.prototype.getExpNextHash=async function(){const{entry:t}=this.explorer.details,e=await this.node.chain.getNextHash(t.hash);return e?util.revHex(e):null},Info.prototype.getExpMerkleRoot=function(){const{entry:t}=this.explorer.details;return util.revHex(t.merkleRoot)},Info.prototype.getExpChainwork=function(){const{entry:t}=this.explorer.details;return t.chainwork.toString("hex",64)},Info.prototype.getExpTxCount=function(){const{block:t}=this.explorer.details;return t.txs.length},Info.prototype.getExpHeight=function(){return this.explorer.details.entry.height},Info.prototype.getExpTimestamp=function(){const{entry:t}=this.explorer.details;return`${new Date(1e3*t.time).format("F j, Y, h:i:s A")}`},Info.prototype.getExpDifficulty=function(){return toDifficulty(this.getExpBits())},Info.prototype.getExpBits=function(){return this.explorer.details.entry.bits},Info.prototype.getExpNonce=function(){return this.explorer.details.entry.nonce},Info.prototype.getExpConfirmation=function(){const{entry:t}=this.explorer.details;return this.node.chain.height-t.height+1},Info.prototype.getExpVersion=function(){const{entry:t}=this.explorer.details;return`0x${util.hex32(t.version)}`},Info.prototype.getExpSize=function(){const{block:t}=this.explorer.details;return`${t.getVirtualSize()} bytes`},Info.prototype.getExpWeight=function(){const{block:t}=this.explorer.details;return`${t.getWeight()} bytes`},Info.prototype.getExpTotalOut=function(){const{txs:t}=this.explorer.details.block;let e=0;for(let o of t)for(let t of o.outputs)e+=t.value;return`${Amount.wmcc(e,!0)} wmcc`},Info.prototype.getExpFee=function(){const{txs:t}=this.explorer.details.block,{height:e}=this.explorer.details.entry;if(0===e)return"0 wmcc";for(let o of t)if(o.isCoinbase()){const t=consensus.getReward(e),n=o.outputs[0].value;return`${Amount.wmcc(n-t,!0)} wmcc`}},Info.prototype.getExpTransactions=async function(){let t="",e=null;const{time:o}=this.explorer.details.block,{txs:n}=this.explorer.details.block;for(let s of n){const n=new Date(1e3*o).format("M d, Y, g:i:s A"),r=util.revHex(s.txid());t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="2"><a class='tx r_goToExp'>${r}</a><i class="glyph-icon flaticon-copy" value=${r} title="Copy"></i>\n      </th><th>${n}</th></tr><tr><td>`;const{details:i,totalout:l,totalin:a}=await this.toDetails(s);t+=toTxTable(i),t+=`</td></tr><tr><td colspan='2'>${e=s.isCoinbase()?`(Size: ${s.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(a-l,!0)} wmcc, Size: ${s.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(l,!0)} wmcc</td></tr></table>`}return t},Info.prototype.setExpAddress=async function(t){try{const e=Address.fromString(t),o=await this.node.chain.getMetaByAddress(t),n=await this.node.chain.getCoinsByAddress(t),s=await this.node.mempool.getAllMetaByAddress(e);return o.push.apply(o,filtermeta(s)),o.sort(compare),this.explorer.details={address:e,metatx:o,coins:n},e||!1}catch(t){return!1}},Info.prototype.getExpAddress=function(){return`(${this.explorer.details.address})`},Info.prototype.getExpAddressSummary=function(){const{address:t,metatx:e,coins:o}=this.explorer.details;let n="",s=0;const r=$('<div id="qrcode"></div>').qrcode(t.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png");for(let t of o)s+=t.value;let i=0;for(let o of e)for(let e of o.tx.outputs){let o=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);t.hash.equals(o)&&(i+=e.value)}return n+='<table class="summary address"><tr><th colspan="5">Summary</th></tr>',n+=`<tr><td>Number of Transactions</td><td><span>${e.length}</span></td><td></td>`,n+=`<td>Total Received</td><td><span>${Amount.wmcc(i,!0)} wmcc</span></td></tr>`,n+=`<tr><td>Address Hash 160</td><td><span class='address'>${t.hash.toString("hex")}</span></td><td></td>`,n+=`<td>Final Balance</td><td><span>${Amount.wmcc(s,!0)} wmcc</span></td></tr>`,n+=`</table><img src="${r}"/>`},Info.prototype.getExpAdressTransactions=async function(t,e){t=parseInt(t)||50,e=parseInt(e)||0;let o="",n=null;const{metatx:s,address:r}=this.explorer.details,i=t+e>s.length?s.length:e+t;for(let t=e;t<i;t++){const e=new Date(1e3*(s[t].time||s[t].mtime)).format("M d, Y, g:i:s A"),i=s[t].tx.txid();o+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',o+=`<tr><th colspan="2"><a class='tx r_goToExp${s[t].block?"":" red' title='Unconfirmed transaction"}'>${util.revHex(i)}</a>\n      <i class="glyph-icon flaticon-copy" value=${util.revHex(i)} title="Copy"></i></th><th>${e}</th></tr><tr><td>`;const{details:l,totalout:a,totalin:c}=await this.toDetails(s[t].tx);o+=toTxTable(l,r.toString()),o+=`</td></tr><tr><td colspan='2'>${n=s[t].tx.isCoinbase()?`(Size: ${s[t].tx.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(c-a,!0)} wmcc, Size: ${s[t].tx.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(a,!0)} wmcc</td></tr></table>`}if(!o)return`<div class='empty'>No transaction found for address: <a>${r}</a></div>`;return o+=page(s.length,e,t,"r_getExpAdressTransactions")},Info.prototype.setExpTransaction=async function(t){try{return this.explorer.details=await this.node.chain.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpTransaction=function(){return`(${util.revHex(this.explorer.details.tx.txid())})`},Info.prototype.getExpTransactionSummary=async function(){let t="";const{tx:e,time:o,mtime:n,height:s,block:r}=this.explorer.details,i=new Date(1e3*(o||n)).format("M d, Y, g:i:s A"),{details:l,totalout:a,totalin:c}=await this.toDetails(e);let h=0,u=0;e.isCoinbase()||(h=Amount.wmcc(c,!0),u=c-a);const p=u>0?Amount.wmcc(policy.getRate(e.getVirtualSize(),u),!0):0,f=u>0?Amount.wmcc(policy.getRate(e.getWeight(),u),!0):0,d=s<0?"N/A":s,g=s<0?"":util.revHex(r),m=s<0?"Unconfirmed Transaction":this.node.chain.height-s+1;return t+='<table class="summary"><tr><th colspan="5">Summary</th></tr>',t+=`<tr><td>Size</td><td><span>${e.getVirtualSize()} bytes</span></td><td></td>`,t+=`<td>Total Input</td><td><span>${h} wmcc</span></td></tr>`,t+=`<tr><td>Weight</td><td><span>${e.getWeight()} bytes</span></td><td></td>`,t+=`<td>Total Output</td><td><span>${Amount.wmcc(a,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Received Time</td><td><span>${i}</span></td><td></td>`,t+=`<td>Fees</td><td><span>${Amount.wmcc(u,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Included In Block</td><td><span${s<0?"":" class='block r_goToExp"}' title='${g}'>${d}</span></td><td></td>`,t+=`<td>Fee per kilobyte</td><td><span>${p} wmcc/kb</span></td></tr>`,t+=`<tr><td>Confirmations</td><td><span>${m}</span></td><td></td>`,t+=`<td>Fee per weight unit</td><td><span>${f} wmcc/kwu</span></td></tr>`,t+="</table>"},Info.prototype.getExpTransactionTable=async function(){let t="";const{tx:e}=this.explorer.details,o=util.revHex(e.txid());t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="3"><a class='tx'>${o}</a><i class="glyph-icon flaticon-copy" value=${o} title="Copy"></i></th></tr><tr><td>`;const{details:n}=await this.toDetails(e);return t+=toTxTable(n),t+="</td></tr></table>"},Info.prototype.getExpScripts=function(){let t="";const{inputs:e,outputs:o}=this.explorer.details.tx;t+='<div class="scripts">',"coinbase"===e[0].getType()?t+="<h2>Coinbase</h2>":t+="<h2>Input Scripts</h2><div>";for(let o of e){const e=o.script.toJSON(),n=o.witness.toString(),s=o.script.getCommitment();e&&(t+=`<h3>${o.script.getInputTypeVal()}</h3>`,t+=`<p>${e}</p>`),s&&(t+="<h3>Commitment hash</h3>",t+=`<p>${s.toString("hex")}</p>`),n&&(t+=`<h3>${o.witness.getInputTypeVal()}</h3>`,t+=`<p>${n}</p>`)}t+='</div><div class="scripts"><h2>Output Scripts</h2>';for(let e of o){t+=`<h3>${e.getType()}</h3>`,t+=`<span>${e.script.toString()}</span>`;const o=e.script.getCommitment();o&&(t+="<h3>Commitment hash</h3>",t+=`<span>${o.toString("hex")}</span>`)}return`${t}</div>`},Info.prototype.setExpPending=async function(t){try{return this.explorer.details=await this.node.mempool.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpPending=function(){return`(${util.revHex(this.explorer.details.tx.txid())})`},Info.prototype.toDetails=async function(t){let e=0,o=0,n=null;const s={output:{},input:{},pending:[]};for(let e of t.inputs){if(t.isCoinbase())continue;const r=await this.node.chain.getTX(e.prevout.hash);r?n=r.outputs:(n=await this.node.mempool.getTX(e.prevout.hash).outputs,s.pending.push(`${n[e.prevout.index].getAddress()}`));const i=n[e.prevout.index].value,l=`${n[e.prevout.index].getAddress()}`;s.input[l]?s.input[l]+=i:s.input[l]=i,o+=i}for(let o of t.outputs){const t=o.script.getAddress()?`${o.script.getAddress()}`:"unknown";s.output[t]?s.output[t]+=o.value:s.output[t]=o.value,e+=o.value}return{details:s,totalin:o,totalout:e}},Info.prototype.isExpHome=function(t){this.explorer.isHome=t},Info.prototype.resetExplorer=function(){this.explorer.details=!1},Info.prototype.getInfoUpdate=function(){let t;const e=__webpack_require__(19).update,o=e.major,n=e.minor;t=`<h2>Major Update ${o.version}</h2><table>`;for(let e of o.info)t+=`<tr><td>${e}</td></tr>`;t+=`</table><h2>Minor Update ${n.version}</h2><table>`;for(let e of n.info)t+=`<tr><td>${e}</td></tr>`;return t+="</table>"},Info.prototype.getInfoClient=function getInfoClient(){let html;const OS=__webpack_require__(8),App=eval("require")("../package.json"),Core=eval("require")("../node_modules/wmcc-core/package.json");return html="<h2>Application Information</h2><table>",html+=`<tr><td>Client Name</td><td>${App.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${App.version}</td></tr>`,html+=`<tr><td>Operating System</td><td>${OS.type()} ${OS.release()} ${OS.arch()}</td></tr>`,html+=`<tr><td>Release Date</td><td>${App.release}</td></tr></table>`,html+="<h2>Core Information</h2><table>",html+=`<tr><td>Client Name</td><td>${Core.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${Core.version}</td></tr>`,html+=`<tr><td>Release Date</td><td>${Core.release}</td></tr></table>`},Info.prototype.getInfoServer=async function(){let t;const e=Core.http.Client(),o=await e.getInfo(),n=new Date(1e3*o.time.system).format("M j, Y, g:i a"),s=new Date(1e3*this.node.chain.tip.time).format("M j, Y, g:i a");return t=`<h2>General</h2><table><tr><td>Version</td><td>${o.version}</td></tr>`,t+=`<tr><td>Network</td><td>${o.network}</td></tr>`,t+=`<tr><td>Data Directory</td><td>${this.node.chain.db.options.prefix}</td></tr>`,t+=`<tr><td>Time</td><td>${n}</td></tr>`,t+=`<tr><td>Uptime</td><td>${age(o.time.uptime,!0)}</td></tr>`,t+="</table><h2>Network</h2><table>",t+=`<tr><td>Host</td><td>${o.pool.host}</td></tr>`,t+=`<tr><td>Port</td><td>${o.pool.port}</td></tr>`,t+=`<tr><td>Agent</td><td>${o.pool.agent}</td></tr>`,t+=`<tr><td>Services</td><td>${o.pool.services}</td></tr>`,t+=`<tr><td>Number of Connections</td><td>In: ${o.pool.inbound} / Out: ${o.pool.outbound}</td></tr>`,t+="</table><h2>Block Chain</h2><table>",t+=`<tr><td>Current Height</td><td>${o.chain.height}</td></tr>`,t+=`<tr><td>Last Block Time</td><td>${s}</td></tr>`,t+=`<tr><td>Progress</td><td>${(100*o.chain.progress).toFixed(2)} <a style='font-family:Ubuntu, sans-serif;'>%</a></td></tr>`,t+="</table><h2>Mempool</h2><table>",t+=`<tr><td>Number of Transactions</td><td>${o.mempool.tx}</td></tr>`,t+=`<tr><td>Memory Usage</td><td>${o.mempool.size}</td></tr></table>`},Info.prototype.getInfoPublicIP=async function(){return await Core.net.external.getIPv4()},Info.prototype.getConfigBasic=async function(){let t="";const e=this.node.config,o=e.getDefault();for(let n of Object.keys(o))if(n){t+=`<h2>${n}</h2>`;for(let s in o[n]){const r=o[n][s][0],i=o[n][s][1],l=o[n][s][2]?"":" disabled",a=o[n][s][3]?` ${o[n][s][3]}`:"",c=s.replace(/-/g,"").toLowerCase(),h=e.data[c]||r;let u;if("bool"===i){u=`<div class="checkbox${l}">\n                 <input type="checkbox" id="checkbox-${s}"${"true"===h?" checked":""}${l} name="${s}" />\n                 <label class="checkbox-off" for="checkbox-${s}"></label></div>`}else u=`<input type='text' class='${i}${a}' value='${h}'${l} name="${s}" />`;t+=`<div>${s} ${r?" (default: "+r+")":""}${u}</div>`}}return t+="<p class='result'></p><submit class=\"button s_configSave\">UPDATE</submit>"},Info.prototype.getStratumInfo=function(){let t;const e=this.node.stratum.options,o=this.node.stratum.inbound.size,n=new Date(1e3*this.node.stratum.lastActive).format("M j, Y, g:i a");return t=`<table><tr><td>Data Directory</td><td>${e.prefix}</td></tr>`,t+=`<tr><td>Public Host</td><td>${e.publicHost}</td></tr>`,t+=`<tr><td>Public Port</td><td>${e.publicPort}</td></tr>`,t+=`<tr><td>Max Inbound</td><td>${e.maxInbound}</td></tr>`,t+=`<tr><td>Difficulty</td><td>${e.difficulty}</td></tr>`,t+=`<tr><td>Last Active</td><td>${n}</td></tr>`,t+=`<tr><td>Connected Workers</td><td>${o}</td></tr></table>`},Info.prototype.getStratumUsers=function(){let t;const e=this.node.stratum.userdb;return e.size?(t="<table class='workerlist'><tr><th>Worker Name</th><th>Password</th><th>Remove Worker</th></tr>",e.map.forEach((e,o,n)=>{t+=`<tr><td>${o}</td><td>★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-remove s_stratumRemoveWorker" title="Remove Worker"></i></td></tr>'}),t+="</table>"):"<table><tr><th>No worker found in userdb.</th></tr></table>"},module.exports=Info},function(t,e){t.exports=require("os")},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);g.call(this,t),this.spv=!1,this.chain=new i({network:this.network,logger:this.logger,workers:this.workers,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),forceFlags:this.config.bool("force-flags"),bip91:this.config.bool("bip91"),bip148:this.config.bool("bip148"),prune:this.config.bool("prune"),checkpoints:this.config.bool("checkpoints"),coinCache:this.config.mb("coin-cache"),entryCache:this.config.uint("entry-cache"),indexTX:this.config.bool("index-tx"),indexAddress:this.config.bool("index-address")}),this.fees=new l(this.logger),this.fees.init(),this.mempool=new a({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,fees:this.fees,db:this.config.str("db"),prefix:this.config.prefix,persistent:this.config.bool("persistent-mempool"),maxSize:this.config.mb("mempool-size"),limitFree:this.config.bool("limit-free"),limitFreeRelay:this.config.uint("limit-free-relay"),requireStandard:this.config.bool("require-standard"),rejectAbsurdFees:this.config.bool("reject-absurd-fees"),replaceByFee:this.config.bool("replace-by-fee"),indexAddress:this.config.bool("index-address")}),this.pool=new c({network:this.network,logger:this.logger,chain:this.chain,mempool:this.mempool,prefix:this.config.prefix,selfish:this.config.bool("selfish"),compact:this.config.bool("compact"),bip37:this.config.bool("bip37"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),maxInbound:this.config.uint("max-inbound"),proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),publicHost:this.config.str("public-host"),publicPort:this.config.uint("public-port"),host:this.config.str("host"),port:this.config.uint("port"),listen:this.config.bool("listen"),persistent:this.config.bool("persistent")}),this.miner=new h({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,mempool:this.mempool,address:this.config.array("coinbase-address"),coinbaseFlags:this.config.str("coinbase-flags"),preverify:this.config.bool("preverify"),maxWeight:this.config.uint("max-weight"),reservedWeight:this.config.uint("reserved-weight"),reservedSigops:this.config.uint("reserved-sigops")}),this.rpc=new u(this),r.unsupported||(this.http=new r({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),port:this.config.uint("http-port"),apiKey:this.config.str("api-key"),noAuth:this.config.bool("no-auth")})),this.client=new m(this),this.walletdb=new p({network:this.network,logger:this.logger,workers:this.workers,client:this.client,prefix:this.config.prefix,db:this.config.str(["wallet-db","db"]),maxFiles:this.config.uint("wallet-max-files"),cacheSize:this.config.mb("wallet-cache-size"),witness:this.config.bool("wallet-witness"),checkpoints:this.config.bool("wallet-checkpoints"),startHeight:this.config.uint("wallet-start-height"),wipeNoReally:this.config.bool("wallet-wipe-no-really"),apiKey:this.config.str(["wallet-api-key","api-key"]),walletAuth:this.config.bool("wallet-auth"),noAuth:this.config.bool(["wallet-no-auth","no-auth"]),ssl:this.config.str("wallet-ssl"),host:this.config.str("wallet-host"),port:this.config.uint("wallet-port"),spv:this.spv,verify:this.spv,listen:!1}),this.stratum=new f({node:this,prefix:this.config.prefix,logger:this.logger,host:this.config.str("stratum-host"),port:this.config.uint("stratum-port"),publicHost:this.config.str("stratum-public-host"),publicPort:this.config.uint("stratum-public-port"),maxInbound:this.config.uint("stratum-max-inbound"),difficulty:this.config.uint("stratum-difficulty"),dynamic:this.config.bool("stratum-dynamic"),password:this.config.str("stratum-password")}),this.auth=new d({network:this.network,logger:this.logger,walletdb:this.walletdb,chain:this.chain,otp:this.config.bool("auth-otp"),alg:this.config.str("hsm-alg"),hash:this.config.str("hsm-hash"),iter:this.config.str("hsm-iter"),r:this.config.str("hsm-r"),p:this.config.str("hsm-p"),length:this.config.str("hsm-length")}),this.http&&this.walletdb.http&&this.walletdb.http.attach(this.http),this.walletdb.rpc.attach(this.rpc),this.info=new w(this),this.attach=new y(this),this._init()}const s=o(0),r=s.http.Server,{Chain:i}=s.blockchain,{Fees:l,Mempool:a}=s.txmempool,{Pool:c}=s.net,{Miner:h}=s.mining,{RPC:u}=s.http,{WalletDB:p}=s.wallet,{Stratum:f}=s.stratum,{Auth:d}=o(14).Credential,g=o(4),m=o(6),y=o(2),w=o(7);Object.setPrototypeOf(n.prototype,g.prototype),n.prototype._init=function(){this.chain.on("error",t=>this.error(t)),this.mempool.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.miner.on("error",t=>this.error(t)),this.walletdb.on("error",t=>this.error(t)),this.stratum.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.mempool.on("tx",t=>{this.miner.cpu.notifyEntry(),this.emit("tx",t)}),this.chain.hook("connect",async(t,e)=>{try{await this.mempool._addBlock(t,e.txs)}catch(t){this.error(t)}this.emit("block",e),this.emit("connect",t,e)}),this.chain.hook("disconnect",async(t,e)=>{try{await this.mempool._removeBlock(t,e.txs)}catch(t){this.error(t)}this.emit("disconnect",t,e)}),this.chain.hook("reorganize",async(t,e)=>{try{await this.mempool._handleReorg()}catch(t){this.error(t)}this.emit("reorganize",t,e)}),this.chain.hook("reset",async t=>{try{await this.mempool._reset()}catch(t){this.error(t)}this.emit("reset",t)}),this.loadPlugins()},n.prototype._open=async function(){await this.chain.open(),await this.mempool.open(),await this.miner.open(),await this.pool.open(),await this.walletdb.open(),await this.stratum.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")},n.prototype._close=async function(){this.http&&await this.http.close(),await this.closePlugins(),await this.stratum.close(),await this.walletdb.close(),await this.pool.close(),await this.miner.close(),await this.mempool.close(),await this.chain.close(),this.logger.info("Node is closed.")},n.prototype.scan=function(t,e,o){return this.chain.scan(t,e,o)},n.prototype.broadcast=async function(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}},n.prototype.sendTX=async function(t){let e;try{e=await this.mempool.addTX(t)}catch(e){if("VerifyError"===e.type&&0===e.score)return this.error(e),this.logger.warning("Verification failed for tx: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);throw e}if(e)return this.logger.warning("TX was orphaned in mempool: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);this.pool.options.selfish&&this.pool.broadcast(t)},n.prototype.relay=async function(t){try{await this.sendTX(t)}catch(t){this.error(t)}},n.prototype.connect=function(){return this.pool.connect()},n.prototype.disconnect=function(){return this.pool.disconnect()},n.prototype.startSync=function(){return this.pool.startSync()},n.prototype.stopSync=function(){return this.pool.stopSync()},n.prototype.getBlock=function(t){return this.chain.getBlock(t)},n.prototype.getCoin=async function(t,e){const o=this.mempool.getCoin(t,e);return o||(this.mempool.isSpent(t,e)?null:await this.chain.getCoin(t,e))},n.prototype.getCoinsByAddress=async function(t){const e=this.mempool.getCoinsByAddress(t),o=await this.chain.getCoinsByAddress(t),n=[];for(const t of o){this.mempool.isSpent(t.hash,t.index)||n.push(t)}for(const t of e)n.push(t);return n},n.prototype.getMetaByAddress=async function(t){const e=this.mempool.getMetaByAddress(t);return(await this.chain.getMetaByAddress(t)).concat(e)},n.prototype.getMeta=async function(t){const e=this.mempool.getMeta(t);return e||await this.chain.getMeta(t)},n.prototype.getMetaView=async function(t){return-1===t.height?this.mempool.getSpentView(t.tx):this.chain.getSpentView(t.tx)},n.prototype.getTXByAddress=async function(t){const e=await this.getMetaByAddress(t),o=[];for(const t of e)o.push(t.tx);return o},n.prototype.getTX=async function(t){const e=await this.getMeta(t);return e?e.tx:null},n.prototype.hasTX=async function(t){return!!this.mempool.hasEntry(t)||await this.chain.hasTX(t)},n.prototype._on=async function(t,e,o){return await this.attach.on(t,e,o)},n.prototype._emit=async function(t,e){return await this.attach.emit(t,e)},n.prototype._call=async function(t,e,o){return o&&Object.keys(o).length?await this[e][t](...Object.values(o)):await this[e][t]()},t.exports=n},function(t,e){},function(t,e,o){"use strict";const n=e;n.cache=function(){},n.Node=o(12),n.attach=o(2),n.config=o(3),n.fullnode=o(9),n.info=o(7),n.logger=o(5),n.node=o(4),n.nodeclient=o(6),n.spvnode=o(10),global.wmcc_node=n},function(t,e,o){"use strict";e.Attach=o(2),e.Config=o(3),e.FullNode=o(9),e.Info=o(7),e.Logger=o(5),e.Node=o(4),e.NodeClient=o(6),e.SpvNode=o(10)},function(t,e){t.exports=require("path")},function(t,e,o){t.exports=function(t){function e(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}([function(t,e){t.exports=o(1)},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.alg=n.alg.PBKDF2,this.hash=n.hashByVal[1],this.iter=1e4,this.salt=Buffer.alloc(0),this.r=0,this.p=0,this.length=32,this.locker=new a,t&&this.fromOptions(t)}function s(t,e){return t.charCodeAt(Math.floor(e%t.length))}const r=o(0),i=o(2),{util:l,Lock:a}=i.utils,{cleanse:c,pbkdf2:h,scrypt:u,digest:p}=i.crypto;n.alg={PBKDF2:0,SCRYPT:1},n.algByVal={0:"PBKDF2",1:"SCRYPT"},n.hash={SHA256:0,SHA512:1},n.hashByVal={0:"SHA256",1:"SHA512"},n.prototype.fromOptions=function(t){return r(t),null!=t.alg&&("string"==typeof t.alg?(this.alg=n.alg[t.alg.toUpperCase()],r(null!=this.alg,"Unknown algorithm.")):(r("number"==typeof t.alg),r(n.algByVal[t.alg]),this.alg=t.alg)),null!=t.hash&&("string"==typeof t.hash?(r(null!=n.hash[t.hash.toUpperCase()],"Unknown hash."),this.hash=n.hashByVal[n.hash[t.hash.toUpperCase()]]):(r("number"==typeof t.hash),r(n.hashByVal[t.hash]),this.hash=n.hashByVal[t.hash])),null!=t.iter&&(r(l.isU32(t.iter)),this.iter=t.iter),null!=t.r&&(r(l.isU32(t.r)),this.r=t.r),null!=t.p&&(r(l.isU32(t.p)),this.p=t.p),null!=t.length&&(r(l.isU32(t.length)),this.length=t.length),this},n.prototype.encrypt=async function(t,e,o){const n=await this.locker.lock();try{return await this._encrypt(t,e,o)}finally{n()}},n.prototype._encrypt=async function(t,e,o){if(!t&&!e&&!o)throw new Error("WalletID, DOB and Secret are required.");r(o instanceof Array);for(let t=0;t<o.length;t++)r(o[t]instanceof Object);return this.hashlock=await this.derive(t,e),this.secret(o)},n.prototype.decrypt=async function(t,e,o){const n=await this.locker.lock();try{return await this._decrypt(t,e,o)}finally{n()}},n.prototype._decrypt=async function(t,e,o){if(!t&&!e&&!o)throw new Error("WalletID, DOB and Lock are required.");if(l.isHex(o)){const t=new RegExp(`.{1,${2*this.length+2}}`,"g"),e=o.match(t);o=[];for(let t=0;t<e.length;t++)o[t]=Buffer.from(e[t],"hex")}else if(Buffer.isBuffer(o)){const t=o,e=this.length+1;o=[];for(let n=0;n<t.length/e;n++)o[n]=t.slice(n*e,n*e+e)}for(let t=0;t<o.length;t++)r(o[t].length===this.length+1);return r(o instanceof Array),this.hashlock=await this.derive(t,e),this.answers=Buffer.alloc(0),this.locks=o.slice(0),this.salt=Buffer.from(e,"utf8"),await this.question()},n.prototype.destroy=async function(){const t=await this.locker.lock();try{return await this._destroy()}finally{t()}},n.prototype._destroy=function(){this.hashlock&&(c(this.hashlock),this.hashlock=null),this.answers&&(this.answers=null),this.locks&&(c(this.locks),this.locks=null)},n.prototype.secret=function(t){if(!this.hashlock)return null;let e={},o=Buffer.alloc(0),n=Buffer.alloc(0);e.locks=[];for(let s=0;s<t.length;s++)e.locks[s]=this.lock(Buffer.from(t[s].question)),n=p.sha256(Buffer.from(t[s].answer)),o=p.sha256(Buffer.concat([o,n]));return e.passphrase=this.passphrase(o),e},n.prototype.lock=function(t){if(!this.hashlock)return null;let e;(e=Buffer.alloc(function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}(t.length,this.length),0)).write(t.toString().replace(/\0/g,""),0);const o=this.hashlock.toString("ascii"),n=Buffer.from(e).toString("ascii"),r=Buffer.from(Array.prototype.map.call(o,function(t,e){return t.charCodeAt(0)^s(n,e)}));return Buffer.concat([Buffer.from([e.length]),r])},n.prototype.passphrase=function(t){if(r(Buffer.isBuffer(t)),!this.hashlock)return null;const e=p.sha256(this.hashlock).toString("ascii"),o=p.sha256(t).toString("ascii");return Buffer.from(Array.prototype.map.call(e,function(t,e){return t.charCodeAt(0)^s(o,e)}))},n.prototype.question=async function(){if(!this.hashlock)return null;let t={};if(this.locks.length){const e=this.hashlock.toString("ascii"),o=this.locks[0].slice(1,this.locks[0][0]+1);this.locks.shift(),t.question=Buffer.from(Array.prototype.map.call(o,function(t,o){return String.fromCharCode(t^s(e,o))}).join("").replace(/\0/g,""))}else t.passphrase=this.passphrase(this.answers);return t},n.prototype.setAnswer=function(t){const e=p.sha256(Buffer.from(t)),o=this.answers?Buffer.concat([this.answers,e]):e;return this.answers=p.sha256(o),this.question()},n.prototype.derive=async function(t,e){const o=this.iter,s=this.hash,r=this.r,i=this.p;switch("string"==typeof t&&Buffer.alloc(this.length,0).write(t.replace(/\0/g,""),0),Buffer.isBuffer(e)||(e=Buffer.from(e,"utf8")),this.alg){case n.alg.PBKDF2:return await h.deriveAsync(t,e,o,this.length,s);case n.alg.SCRYPT:return await u.deriveAsync(t,e,o,r,i,this.length);default:throw new Error(`Unknown algorithm: ${this.alg}.`)}},n.toObject=function(t){let e;return Array.isArray(t.locks)?e=l.concatArrBuf(t.locks):"string"==typeof t.locks?(r(l.isHex(t.locks)),e=Buffer.from(t.locks,"hex")):e=t.locks,r(Buffer.isBuffer(e)),r(Buffer.isBuffer(t.passphrase)),{lock:e,chksum:t.passphrase.slice(0,4)}},t.exports=n},function(t,e){t.exports=o(0)},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.enable=t,this.code=null,this.key=null,this.retry=0,this.maxtry=5}const s=o(0),r=o(6),i=o(4),l=o(2),{digest:a}=l.crypto;n.prototype.encode=function(t){s(t,"Passphrase required.");const e=Math.floor(9e3*Math.random())+1e3;this.code=r.randomBytes(16).toString("hex");const o=this._generateCode(e);return this.key=i.encrypt(t,o),e},n.prototype.decode=function(t,e){s(this.code,"OTP must be instantiate first");let o;const n=this._generateCode(t);try{o=Buffer.from(i.decrypt(this.key,n),"ascii")}catch(t){return this.retry++,this.retry>this.maxtry-1&&setTimeout(()=>{location.reload()},2e3),!1}return this.retry=0,e?{passphrase:o,otp:this.encode(o)}:o},n.prototype._generateCode=function(t){s(t,"OTP required.");let e;for(let o=0;o<t;o++)0===o&&(e=this.code),e=a.sha256(Buffer.from(e)).toString("ascii");return e},n.prototype.isEnabled=function(){return this.enable},t.exports=n},function(t,e,o){"use strict";const n=t.exports;let s,r=[],i=[];n.encrypt=function(t,e){const o=n._UTF8.stringToBytes(t),s=n._utils.randomBytes(8),r=e.constructor==String?n._PBKDF2(e,s,32,{asBytes:!0}):e;return n._internal(o,r,n._utils.bytesToWords(s)),n._utils.bytesToHex(s.concat(o))},n.decrypt=function(t,e){const o=n._utils.hexToBytes(t),s=o.splice(0,8),r=e.constructor==String?n._PBKDF2(e,s,32,{asBytes:!0}):e;return n._internal(o,r,n._utils.bytesToWords(s)),n._UTF8.bytesToString(o)},n._internal=function(t,e,o){n._keysetup(e),o&&n._ivsetup(o);let s=[];for(let e=0;e<t.length;e++){if(e%16==0){n._nextstate(),s[0]=r[0]^r[5]>>>16^r[3]<<16,s[1]=r[2]^r[7]>>>16^r[5]<<16,s[2]=r[4]^r[1]>>>16^r[7]<<16,s[3]=r[6]^r[3]>>>16^r[1]<<16;for(let t=0;t<4;t++)s[t]=16711935&(s[t]<<8|s[t]>>>24)|4278255360&(s[t]<<24|s[t]>>>8);for(let t=120;t>=0;t-=8)s[t/8]=s[t>>>5]>>>24-t%32&255}t[e]^=s[e%16]}},n._keysetup=function(t){r[0]=t[0],r[2]=t[1],r[4]=t[2],r[6]=t[3],r[1]=t[3]<<16|t[2]>>>16,r[3]=t[0]<<16|t[3]>>>16,r[5]=t[1]<<16|t[0]>>>16,r[7]=t[2]<<16|t[1]>>>16,i[0]=n._utils.rotl(t[2],16),i[2]=n._utils.rotl(t[3],16),i[4]=n._utils.rotl(t[0],16),i[6]=n._utils.rotl(t[1],16),i[1]=4294901760&t[0]|65535&t[1],i[3]=4294901760&t[1]|65535&t[2],i[5]=4294901760&t[2]|65535&t[3],i[7]=4294901760&t[3]|65535&t[0],s=0;for(let t=0;t<4;t++)n._nextstate();for(let t=0;t<8;t++)i[t]^=r[t+4&7]},n._ivsetup=function(t){const e=n._utils.endian(t[0]),o=n._utils.endian(t[1]),s=e>>>16|4294901760&o,r=o<<16|65535&e;i[0]^=e,i[1]^=s,i[2]^=o,i[3]^=r,i[4]^=e,i[5]^=s,i[6]^=o,i[7]^=r;for(let t=0;t<4;t++)n._nextstate()},n._nextstate=function(){let t=[];for(let e=0;e<8;e++)t[e]=i[e];i[0]=i[0]+1295307597+s>>>0,i[1]=i[1]+3545052371+(i[0]>>>0<t[0]>>>0?1:0)>>>0,i[2]=i[2]+886263092+(i[1]>>>0<t[1]>>>0?1:0)>>>0,i[3]=i[3]+1295307597+(i[2]>>>0<t[2]>>>0?1:0)>>>0,i[4]=i[4]+3545052371+(i[3]>>>0<t[3]>>>0?1:0)>>>0,i[5]=i[5]+886263092+(i[4]>>>0<t[4]>>>0?1:0)>>>0,i[6]=i[6]+1295307597+(i[5]>>>0<t[5]>>>0?1:0)>>>0,i[7]=i[7]+3545052371+(i[6]>>>0<t[6]>>>0?1:0)>>>0,s=i[7]>>>0<t[7]>>>0?1:0;let e=[];for(let t=0;t<8;t++){const o=r[t]+i[t]>>>0,n=65535&o,s=o>>>16,l=((n*n>>>17)+n*s>>>15)+s*s,a=((4294901760&o)*o>>>0)+((65535&o)*o>>>0)>>>0;e[t]=l^a}r[0]=e[0]+(e[7]<<16|e[7]>>>16)+(e[6]<<16|e[6]>>>16),r[1]=e[1]+(e[0]<<8|e[0]>>>24)+e[7],r[2]=e[2]+(e[1]<<16|e[1]>>>16)+(e[0]<<16|e[0]>>>16),r[3]=e[3]+(e[2]<<8|e[2]>>>24)+e[1],r[4]=e[4]+(e[3]<<16|e[3]>>>16)+(e[2]<<16|e[2]>>>16),r[5]=e[5]+(e[4]<<8|e[4]>>>24)+e[3],r[6]=e[6]+(e[5]<<16|e[5]>>>16)+(e[4]<<16|e[4]>>>16),r[7]=e[7]+(e[6]<<8|e[6]>>>24)+e[5]},n._utils={randomBytes:function(t){let e=[];for(;t>0;t--)e.push(Math.floor(256*Math.random()));return e},randomHex:function(t){return n._utils.bytesToHex(n._utils.randomBytes(t))},wordsToBytes:function(t){let e=[];for(let o=0;o<32*t.length;o+=8)e.push(t[o>>>5]>>>24-o%32&255);return e},bytesToWords:function(t){let e=[];for(let o=0,n=0;o<t.length;o++,n+=8)e[n>>>5]|=t[o]<<24-n%32;return e},bytesToHex:function(t){let e=[];for(let o=0;o<t.length;o++)e.push((t[o]>>>4).toString(16)),e.push((15&t[o]).toString(16));return e.join("")},hexToBytes:function(t){let e=[];for(let o=0;o<t.length;o+=2)e.push(parseInt(t.substr(o,2),16));return e},wordsToHex:function(t){return new Buffer(Buffer.from(t).toString("hex"))},rotl:function(t,e){return t<<e|t>>>32-e},endian:function(t){if(t.constructor==Number)return 16711935&n._utils.rotl(t,8)|4278255360&n._utils.rotl(t,24);for(let e=0;e<t.length;e++)t[e]=n._utils.endian(t[e]);return t}},n._UTF8={stringToBytes:function(t){return n._Binary.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){try{return decodeURIComponent(escape(n._Binary.bytesToString(t)))}catch(t){throw new Error("ERROR DECODING URI: "+t.message)}}},n._Binary={stringToBytes:function(t){let e=[];for(let o=0;o<t.length;o++)e.push(255&t.charCodeAt(o));return e},bytesToString:function(t){let e=[];for(let o=0;o<t.length;o++)e.push(String.fromCharCode(t[o]));return e.join("")}},n._PBKDF2=function(t,e,o,s){function r(t,e){return n._HMAC(i,e,t,{asBytes:!0})}t.constructor==String&&(t=n._UTF8.stringToBytes(t)),e.constructor==String&&(e=n._UTF8.stringToBytes(e));const i=s&&s.hasher||n._SHA1,l=s&&s.iterations||1;let a=[],c=1;for(;a.length<o;){let o=r(t,e.concat(n._utils.wordsToBytes([c]))),s=o;for(let e=1;e<l;e++){s=r(t,s);for(let t=0;t<o.length;t++)o[t]^=s[t]}a=a.concat(o),c++}return a.length=o,s&&s.asBytes?a:s&&s.asString?n._Binary.bytesToString(a):n._utils.bytesToHex(a)},n._SHA1=function(t,e){const o=n._utils.wordsToBytes(n._SHA1._internal(t));return e&&e.asBytes?o:e&&e.asString?n._Binary.bytesToString(o):n._utils.bytesToHex(o)},n._SHA1._internal=function(t){t.constructor==String&&(t=n._UTF8.stringToBytes(t));let e=n._utils.bytesToWords(t),o=8*t.length,s=[],r=1732584193,i=-271733879,l=-1732584194,a=271733878,c=-1009589776;e[o>>5]|=128<<24-o%32,e[15+(o+64>>>9<<4)]=o;for(let t=0;t<e.length;t+=16){let o=r,n=i,h=l,u=a,p=c;for(let o=0;o<80;o++){if(o<16)s[o]=e[t+o];else{let t=s[o-3]^s[o-8]^s[o-14]^s[o-16];s[o]=t<<1|t>>>31}const n=(r<<5|r>>>27)+c+(s[o]>>>0)+(o<20?1518500249+(i&l|~i&a):o<40?1859775393+(i^l^a):o<60?(i&l|i&a|l&a)-1894007588:(i^l^a)-899497514);c=a,a=l,l=i<<30|i>>>2,i=r,r=n}r+=o,i+=n,l+=h,a+=u,c+=p}return[r,i,l,a,c]},n._HMAC=function(t,e,o,s){e.constructor==String&&(e=n._UTF8.stringToBytes(e)),o.constructor==String&&(o=n._UTF8.stringToBytes(o)),o.length>4*t._blocksize&&(o=t(o,{asBytes:!0}));let r=o.slice(0),i=o.slice(0);for(let e=0;e<4*t._blocksize;e++)r[e]^=92,i[e]^=54;const l=t(r.concat(t(i.concat(e),{asBytes:!0})),{asBytes:!0});return s&&s.asBytes?l:s&&s.asString?n._Binary.bytesToString(l):n._utils.bytesToHex(l)},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=new s(t),this.network=this.options.network,this.logger=this.options.logger.context("authentication"),this.locker=new p,this.templocker=new p,this.hsm=new l({alg:this.options.alg,hash:this.options.hash,iter:this.options.iter,r:this.options.r,p:this.options.p,length:this.options.length}),this.otp=new a(this.options.otp),this.opened=!1,this.logged=!1,this.maxLock=10,this.wallets=[],this.load()}function s(t){if(!(this instanceof s))return new s(t);this.network=f.primary,this.logger=c.global,this.otp=!0,t&&this.fromOptions(t)}const r=o(6),i=o(0),l=o(1),a=o(3),c=o(9),h=o(2),{fs:u,Lock:p}=h.utils,{Network:f}=h.protocol;n.prototype.load=function(){this.logged?$("body").html("<menu><topmenu category='menu' module='top' tag='topmenu' active='true'></topmenu></menu><content></content>\n      <preload category='preload' module='preload' tag='preload' active='true'></preload>\n      <updater category='update' module='update' tag='updater' active='true'></updater>\n      <notification category='notification' module='main' tag='notification' active='true'></notification>"):$("body").html("<logo><img src='../image/head_logo.png'></logo><menu><tabs category='menu' module='auth' tag='tabs' active='true'></tabs></menu>\n      <content></content><preload category='preload' module='preload' tag='preload' active='true'></preload>\n      <copyright>WMCC Application &copy; World Mobile Coin</copyright>\n      \x3c!--<updater category='update' module='update' tag='updater' active='true'></updater>--\x3e")},n.prototype.open=async function(t,e){const o=await this.locker.lock();try{return await this._open(t,e)}finally{o()}},n.prototype._open=async function(t,e){i("object"==typeof t),i("object"==typeof e),e.loaded||await e.open(),await t.open(),this.opened=!0},n.prototype.tempopen=async function(t,e){const o=await this.templocker.lock();try{return await this._tempopen(t,e)}finally{o()}},n.prototype._tempopen=async function(t,e){i("object"==typeof t),i("object"==typeof e),e.loaded||await e.open();const o=t.bound;this.opened&&(t.bound=!0),await t.db.open(),t.bound=o,this.opened=!0},n.prototype.tempclose=async function(t,e){const o=await this.templocker.lock();try{return await this._tempclose(t,e)}finally{o()}},n.prototype._tempclose=async function(t,e){i("object"==typeof t),await t.db.close(),e&&(i("object"==typeof e),await e.close()),this.opened=!1},n.prototype.close=async function(t,e){const o=await this.locker.lock();try{return await this._close(t,e)}finally{o()}},n.prototype._close=async function(t,e){i("object"==typeof t),await t.close(),e&&(i("object"==typeof e),await e.close()),this.opened=!1},n.prototype.render=async function(t,e){const o=e.info.wallet?e.info.wallet.account.id:null,n=t.list(),s=[];if(n.length>0){for(let e of n){const n=e.split(".").shift();try{const e=this.fromSuffix(n);if(e===o)continue;s.push(e)}catch(t){}}s.sort();for(let t of s)$('select[name="name"]').append(`<option value="${t}">${t}</option>`),this.wallets=this.wallets.filter(e=>e!==t).concat([t])}this.wallets.length>0||$('menubutton[category="auth"][module="create"]').trigger("click")},n.prototype.saveWallet=async function(t,e,o,n,s){let r=await this.hsm.encrypt(o,n,s);const i=this.toSuffix(o);t.suffix(i),await this.ensure(t.db.db.location),await this.open(t,e),await t.set({id:o,hsm:r}),await this.hsm.destroy(),await this.close(t),r={}},n.prototype.ensure=function(t){return u.unsupported?Promise.resolve():u.mkdirp(t)},n.prototype.getOTP=function(t){return this.otp.encode(t)},n.prototype.getPassphrase=function(t,e){return this.otp.decode(t,e)},n.prototype.isOtpEnabled=function(){return this.otp.isEnabled()},n.prototype.getMaxLock=function(){return this.maxLock},n.prototype.toSuffix=function(t){const e=r.createCipher("aes128","wmcc-wallet");return`${e.update(t,"utf8","hex")}${e.final("hex")}`},n.prototype.fromSuffix=function(t){const e=r.createDecipher("aes128","wmcc-wallet");return`${e.update(t,"hex","utf8")}${e.final("utf8")}`},n.prototype.destroy=function(){this.opened=!1,this.logged=!1},s.prototype.fromOptions=function(t){null!=t.network&&(this.network=f.get(t.network)),null!=t.logger&&(i("object"==typeof t.logger),this.logger=t.logger),null!=t.otp&&(i("boolean"==typeof t.otp),this.otp=t.otp),null!=t.alg&&(i("string"==typeof t.alg||"number"==typeof t.alg),this.alg=t.alg),null!=t.hash&&(i("string"==typeof t.hash||"number"==typeof t.hash),this.hash=t.hash),null!=t.iter&&(i("number"==typeof t.iter),this.iter=t.iter),null!=t.r&&(i("number"==typeof t.r),this.r=t.r),null!=t.p&&(i("number"==typeof t.p),this.p=t.p),null!=t.length&&(i("number"==typeof t.length),this.length=t.length)},s.fromOptions=function(t){return(new s).fromOptions(t)},t.exports=n},function(t,e){t.exports=o(15)},function(t,e,o){"use strict";const n=e;n.cache=function(){},n.Credential=o(8),n.auth=o(5),n.hsm=o(1),n.otp=o(3),n.rabbit=o(4),global.wmcc_credential=n},function(t,e,o){"use strict";e.Auth=o(5),e.HSM=o(1),e.OTP=o(3),e.Rabbit=o(4)},function(t,e){t.exports=o(16)}])},function(t,e){t.exports=require("crypto")},function(t,e,o){t.exports=function(t){function e(n){if(o[n])return o[n].exports;var s=o[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,o){"use strict";t.exports=o(1)},function(t,e,o){"use strict";function n(t){return Math.floor(t/(1<<20))}function s(t){return new Promise((e,o)=>{const n=a.createWriteStream(t,{flags:"a"}),s=()=>{n.removeListener("error",r),n.removeListener("open",i)},r=t=>{try{n.close()}catch(t){}s(),o(t)},i=()=>{s(),e(n)};n.once("error",r),n.once("open",i)})}const r=o(2),{format:i,inspect:l}=o(3),a=o(4),c={showHidden:!1,depth:20,colors:!1,customInspect:!0,showProxy:!1,maxArrayLength:1/0,breakLength:60};class h{constructor(t){this.level=h.levels.NONE,this.colors=h.HAS_TTY,this.console=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),t&&this.set(t)}set(t){r(t),r(this.closed),"string"!=typeof t?(null!=t.level&&(r("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&h.HAS_TTY&&(r("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(r("boolean"==typeof t.console),this.console=t.console),null!=t.shrink&&(r("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(r("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)}async open(){this.filename?this.stream?this.closed=!1:a.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await s(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1}async close(){if(null!=this.timer&&(clearTimeout(this.timer),this.timer=null),a.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await(t=this.stream,new Promise((e,o)=>{const n=()=>{t.removeListener("error",s),t.removeListener("close",r)},s=t=>{n(),o(t)},r=()=>{n(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",s),t.once("close",r),t.close()}))}finally{this.closing=!1}this.stream=null}var t;this.closed=!0}async truncate(){if(!this.filename)return;if(a.unsupported)return;let t;r(!this.stream);try{t=await a.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const e=h.MAX_FILE_SIZE;if(t.size<=e+e/10)return;this.debug("Truncating log file to %dmb.",n(e));const o=await a.open(this.filename,"r+"),s=Buffer.allocUnsafe(e);await a.read(o,s,0,e,t.size-e),await a.ftruncate(o,e),await a.write(o,s,0,e,0),await a.close(o)}handleError(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()}async reopen(){if(!this.stream&&!this.closed&&!a.unsupported){try{this.stream=await s(this.filename)}catch(t){return void this.retry()}this.stream.once("error",t=>this.handleError(t))}}retry(){null==this.timer&&(this.timer=setTimeout(()=>{this.timer=null,this.reopen()},1e4))}setFile(t){r("string"==typeof t),r(!this.stream,"Log stream has already been created."),this.filename=t}setLevel(t){const e=h.levels[t.toUpperCase()];r(null!=e,"Invalid log level."),this.level=e}fmt(t,e){if(t.length>0){const[o]=t;if(o&&"object"==typeof o)return c.colors=e,l(o,c)}return i(...t)}error(...t){if(this.level<h.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(h.levels.ERROR,null,e):this.log(h.levels.ERROR,null,t)}warning(...t){if(this.level<h.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(h.levels.WARNING,null,e):this.log(h.levels.WARNING,null,t)}info(...t){if(this.level<h.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(h.levels.INFO,null,e):this.log(h.levels.INFO,null,t)}debug(...t){if(this.level<h.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(h.levels.DEBUG,null,e):this.log(h.levels.DEBUG,null,t)}spam(...t){if(this.level<h.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(h.levels.SPAM,null,e):this.log(h.levels.SPAM,null,t)}log(t,e,o){this.closed||this.level<t||(this.writeConsole(t,e,o),this.writeStream(t,e,o))}context(t){let e=this.contexts[t];return e||(e=new u(this,t),this.contexts[t]=e),e}writeConsole(t,e,o){const n=h.levelsByVal[t];if(r(n,"Invalid log level."),!this.console)return!1;if(!process.stdout){let s=`[${n}] `;if(e&&(s+=`(${e}) `),o.length>0){const[e]=o;if(e&&"object"==typeof e)return t===h.levels.ERROR?console.error(s,e):console.log(s,e)}return s+=this.fmt(o,!1),t===h.levels.ERROR?console.error(s):console.log(s),!0}let s;if(this.colors){const e=h.styles[t];r(e),s=`[${e}m[${n}][m `}else s=`[${n}] `;return e&&(s+=`(${e}) `),s+=this.fmt(o,this.colors),s+="\n",t===h.levels.ERROR?process.stderr.write(s):process.stdout.write(s)}writeStream(t,e,o){const n=h.prefixByVal[t];if(r(n,"Invalid log level."),!this.stream)return;if(this.closing)return;let s=`[${n}:${(new Date).toISOString().slice(0,-5)+"Z"}] `;e&&(s+=`(${e}) `),s+=this.fmt(o,!1),s+="\n",this.stream.write(s)}logError(t,e,o){if(this.closed)return;a.unsupported&&this.console&&t<=h.levels.WARNING&&console.error(o);let n=String(o.message).replace(/^ *Error: */,"");t!==h.levels.ERROR&&(n=`Error: ${n}`),this.log(t,e,[n]),t<=h.levels.WARNING&&this.stream&&this.stream.write(o.stack+"\n")}memoryUsage(){if(!process.memoryUsage)return{total:0,jsHeap:0,jsHeapTotal:0,nativeHeap:0,external:0};const t=process.memoryUsage();return{total:n(t.rss),jsHeap:n(t.heapUsed),jsHeapTotal:n(t.heapTotal),nativeHeap:n(t.rss-t.heapTotal),external:n(t.external)}}memory(t){const e=this.memoryUsage();this.log(h.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])}}class u{constructor(t,e){r("string"==typeof e),this.logger=t,this.module=e}open(){return this.logger.open()}close(){return this.logger.close()}setFile(t){this.logger.setFile(t)}setLevel(t){this.logger.setLevel(t)}error(...t){if(this.logger.level<h.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(h.levels.ERROR,e):this.log(h.levels.ERROR,t)}warning(...t){if(this.logger.level<h.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(h.levels.WARNING,e):this.log(h.levels.WARNING,t)}info(...t){if(this.logger.level<h.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(h.levels.INFO,e):this.log(h.levels.INFO,t)}debug(...t){if(this.logger.level<h.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(h.levels.DEBUG,e):this.log(h.levels.DEBUG,t)}spam(...t){if(this.logger.level<h.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(h.levels.SPAM,e):this.log(h.levels.SPAM,t)}log(t,e){this.logger.log(t,this.module,e)}context(t){return new u(this.logger,t)}logError(t,e){this.logger.logError(t,this.module,e)}memoryUsage(){return this.logger.memoryUsage()}memory(){this.logger.memory(this.module)}}h.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),h.MAX_FILE_SIZE=20<<20,h.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},h.levelsByVal=["none","error","warning","info","debug","spam"],h.prefixByVal=["N","E","W","I","D","S"],h.styles=["0","1;31","1;33","94","90","90"],h.global=new h,t.exports=h},function(t,e){t.exports=o(1)},function(t,e){t.exports=o(17)},function(t,e,o){"use strict";function n(t){return function(...e){return new Promise((o,n)=>{e.push((o=o,n=n,function(t,e){t?n(t):o(e)})),t.call(this,...e)})}}const s=o(5);e.stat=n(s.stat),e.open=n(s.open),e.close=n(s.close),e.read=n(s.read),e.write=n(s.write),e.ftruncate=n(s.ftruncate),e.createWriteStream=s.createWriteStream},function(t,e){t.exports=o(18)}])},function(t,e){t.exports=require("util")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("../update/information.json")}]);
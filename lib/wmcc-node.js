module.exports=function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=11)}([function(t,e){t.exports=require("wmcc-core")},function(t,e){t.exports=require("assert")},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.node=t,this.events=[],this.init()}o(1);const i=o(0),{Lock:s}=i.utils,{Amount:r}=i.wmcc;n.prototype.init=function(){const t=this,e=(e,o)=>{let n=t.events.mempool;for(let i in n)t.emit(n[i].event,"mempool",n[i].el,{tx:e,view:o})};this.node.mempool.listeners("tx").filter(t=>t.toString()===e.toString()).length&&this.node.mempool.removeListener("tx",e),this.node.mempool.on("tx",e);const o=async(e,o)=>{let n=t.events.chain;for(let e in n)t.emit(n[e].event,"chain",n[e].el)};this.node.chain.listeners("block").filter(t=>t.toString()===o.toString()).length&&this.node.chain.removeListener("block",o),this.node.chain.on("block",o);const n=()=>{let e=t.events.balance;for(let o in e)t.emit(e[o].event,"balance",e[o].el)};this.node.walletdb.listeners("hook balance").filter(t=>t.toString()===n.toString()).length&&this.node.walletdb.removeListener("hook balance",n),this.node.walletdb.on("hook balance",n);const i=e=>{let o=t.events.miner;for(let n in o)t.emit(o[n].event,"miner",o[n].el,{attempt:e})};this.node.miner.listeners("miner block").filter(t=>t.toString()===i.toString()).length&&this.node.miner.removeListener("miner block",i),this.node.miner.on("miner block",i);const s=async(e,o)=>{let n=t.events.notification;for(let i in n)t.emit(n[i].event,"notification",n[i].el,{block:e,entry:o,prepend:!0})};this.node.miner.listeners("miner found").filter(t=>t.toString()===s.toString()).length&&this.node.miner.removeListener("miner found",s),this.node.miner.on("miner found",s),this.node.chain.db.on("rescan",()=>{t.node.walletdb.rescan(0)}),this.node.chain.db.on("block scan",(e,o)=>{"undefined"!=typeof $&&($("preload").show(),$("preloadcontent").html(`<span class='scanning'>Scanning block ${o}: <a>${e}</a></span>`),t.node.chain.tip.height===o&&$("preload").hide())})},n.prototype.on=async function(t,e,o,n){this.events[e]||(this.events[e]=[]);const i={event:t,el:o};return this.events[e].filter((e,n)=>e.event===t||e.el===o).length||this.events[e].push(i),this.events[e]=this.events[e].map(t=>Object.assign(t,[i].find(e=>e&&t.event===e.event))),await this.emit(t,e,o,n)},n.prototype.add=async function(t,e,o,n){return await this.on(t,e,o,n)},n.prototype.emit=async function(t,e,o,n){try{let i;return i=n&&Object.keys(n).length?await this[t](...Object.values(n)):await this[t](),void(n&&n.append?o.append(i):n&&n.prepend?o.prepend(i):o.html(i))}catch(o){if("TypeError"!==o.name)throw o;console.log(`Unable to attach 'on' event for ${e}::${t}`)}},n.prototype.getBalance=async function(){return await this.node.info.wallet.getBalanceDetails(this.node.info.getAccountName())},n.prototype.getTotal=async function(t){const e=t||await this.getBalance();return r.text(e.total)},n.prototype.getAvailable=async function(t){const e=t||await this.getBalance();return r.text(e.available)},n.prototype.getPending=async function(t){const e=t||await this.getBalance();return r.text(e.pending)},n.prototype.getImmature=async function(t){const e=t||await this.getBalance();return r.text(e.immature)},n.prototype.getRecentTransactions=async function(){let t,e="";try{t=await this.node.info.wallet.getLast(this.node.info.wallet.account.name,5)}catch(t){return`<h2>${t}</h2>`}for(let o of t){o=await this.node.info.wallet.toDetails(o);const t=new Date(1e3*o.mtime).format("d-m-Y");let n=0,i=null;for(let t of o.inputs)t.path&&(n+=t.value,i="out"),0===o.time&&(i="out sending");if(n){n=0;for(let t of o.outputs)t.path||(n+=t.value,i="out")}else{for(let t of o.outputs)t.path&&(n+=t.value,i="in");0===o.time&&(i="in receiving"),o.tx.isCoinbase()&&(i="rig")}e+=`<holder><i class="glyph-icon flaticon-${i}"></i><span>`,e+=`<label>${t}</label><label>${r.wmcc(n,!0)} wmcc</label>`,e+=`<a><label class='r_goToExp' value="${o.hash}">Show Details</label></a></span></holder>`}return e||"<holder><h2>No recent transaction found.</h2></holder>"},n.prototype.getUnconfirmTxCount=function(){return this.node.mempool.getCount()},n.prototype.getUnconfirmTxSize=function(){return function(t){return t<1048576?(t/1024).toFixed(3):t<1073741824?(t/1024).toFixed(0):void 0}(this.node.mempool.getSize())},n.prototype.getLatestTxs=function(t,e){let o="";if(t){const e=[t.hash("hex"),t.getOutputValue()];if(!this._latesttxs.indexOf(e))return;this._latesttxs.push(e)}else this._latesttxs=[],this.node.mempool.map.forEach((t,e)=>{this._latesttxs.push([e,t.value])});const n=this._latesttxs.length,i=this._latesttxs.slice(Math.max(0,n-5),n);if(i.length){o+="<table>";for(let t=i.length-1;t>=0;t--)o+=`<tr><td><a title='${i[t][0]}' class='r_goToExp'>${i[t][0]}<a></td>`,o+=`<td>${r.wmcc(i[t][1],!0)}</td></tr>`;o+="</table>"}else o="<h2>No transaction in mempool.</h2>";return o},n.prototype.getCurrentBlock=async function(){let t="";const e=this.node.chain.height,o=this.node.chain.tip.rhash(),n=await this.node.chain.getEntry(e),i=await this.node.chain.getBlock(n.hash);return t+="<table>",t+=`<tr><td>Tip</td><td colspan='3'><a title='${o}'>${o}</a></td></tr>`,t+=`<tr><td>Hash</td><td colspan='3'><a title='${n.rhash()}' class='r_goToExp'>${n.rhash()}</a></td></tr>`,t+=`<tr><td>Height</td><td>${e}</td>`,t+=`<td>Age</td><td>${function(t,e){let o=e?t:Math.abs(Date.now()/1e3-t),n="",i={},s=0;const r={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(r).forEach(function(t){i[t]=Math.floor(o/r[t]),o-=i[t]*r[t],i[t]&&s<1&&(s++,n+=` ${i[t]} ${t}${i[t]>1?"s":""}`)}),`${n}${e?"":" ago"}`}(n.time)}</td></tr>`,t+=`<tr><td>Txns<a></td><td>${i.txs.length}</td>`,t+=`<td>Outputs</td><td>${r.wmcc(i.getClaimed())} wmcc</td></tr>`,t+=`<tr><td>Size</td><td>${i.getVirtualSize()/1e3} kb</td>`,t+=`<td>Weight</td><td>${i.getWeight()/1e3} kwu</td></tr>`},n.prototype.destroy=async function(){},n.prototype.getMinerInfo=function(t){this._getMinerInfo&&!t&&(t=this._getMinerInfo);let e="<table>";return t?(this._getMinerInfo=t,e+=`<tr><td>Address</td><td colspan="3"><a title='${t.address}' class='r_goToExp'>${t.address}</a></td></tr>`,e+=`<tr><td>Height</td><td>${t.height}</td><td>Fees</td><td>${r.wmcc(t.fees)} wmcc</td></tr>`,e+=`<tr><td>Transactions</td><td>${t.items.length+1}</td><td>Difficulty</td><td>${function(t){let e=t>>>24&255,o=65535/(16777215&t);for(;e<29;)o*=256,e++;for(;e>29;)o/=256,e--;return o.toFixed(12)}(t.bits)}</td></tr>`):e+=`<tr><td colspan="2" class="ellipse">Address: ${this.node.info.getAddress()}</td></tr>`,e+="<table>"},n.prototype.minerFoundBlock=function(t,e){if("object"!=typeof t)return;let o="";return o+='<table class=\'minerfound\'><tr><th rowspan="3"><i class="glyph-icon flaticon-remove"></i><i class="glyph-icon flaticon-rig"></i></th>',o+='<th colspan="2">Found New Block!</th></tr>',o+=`<tr><td>Block height</td><td>: ${e.height}</td></tr>`,o+=`<tr><td>Block reward</td><td>: ${r.wmcc(t.txs[0].outputs[0].value)} wmcc</td></tr></table>`},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);c("string"==typeof t),c(t.length>0),this.module=t,this.network="mainnet",this.prefix=h.join(g,`.${t}`),this.options=Object.create(null),this.data=Object.create(null),this.env=Object.create(null),this.args=Object.create(null),this.argv=[],this.pass=[],this.query=Object.create(null),this.hash=Object.create(null)}function i(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Argument #${t}`:t}function s(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t=t.replace(/\0/g,"")}function r(t){return/^[a-z0-9]+$/.test(t)}function a(t){return/^[a-zA-Z0-9]+$/.test(t)}function l(t){return!!a(t)&&!/[A-Z]/.test(t)}const c=o(1),h=o(13),p=o(8),u=o(0),{fs:d,util:f}=u.utils,g=p.homedir?p.homedir():"/";n.alias={seed:"seeds",node:"nodes",n:"network"},n.default={Options:{network:["mainnet","str",!1]},Node:{prefix:["~/.wmcc","str",!0],db:["leveldb","str",!1],"max-files":["512","uint",!0],"cache-size":["100","mb",!0]},Logger:{"log-level":["error","str",!0],"log-file":["true","bool",!0]},Chain:{prune:["false","bool",!1],"index-tx":["true","bool",!1],"index-address":["true","bool",!1]},Mempool:{"mempool-size":["100","mb",!0],"persistent-mempool":["false","bool",!1]},Pool:{listen:["true","bool",!1],"max-outbound":["32","uint",!0],"max-inbound":["128","uint",!0]},"Localhost (to listen on)":{host:["::","str",!0],port:["8880","uint",!0]},"Public Host (to advertise to peers)":{"public-host":["127.0.0.1","str",!0],"public-port":["8880","uint",!0]},"HTTP / RPC":{"http-host":["::","str",!0],"http-port":["7880","uint",!0],"api-key":["","str",!0],"no-auth":["false","bool",!0]},"Stratum Host (to listen to miners)":{"stratum-host":["0.0.0.0","str",!0],"stratum-port":["6880","uint",!0],"stratum-public-host":["127.0.0.1","str",!0],"stratum-public-port":["6880","uint",!0],"stratum-max-inbound":["50","uint",!0],"stratum-notify-interval":["60","uint",!0],"stratum-difficulty":["1","uint",!0]},Miner:{"coinbase-flags":["mined by wmcc_user","str",!0,"r_maxsize"],"coinbase-address":["","str",!0,"r_checkAddress extrawidth"]},Wallet:{"wallet-witness":["true","bool",!0]}},n.prototype.getDefault=function(){return n.default},n.prototype.inject=function(t){for(const e of Object.keys(t)){const o=t[e];switch(e){case"hash":case"query":case"env":case"argv":case"config":continue}this.set(e,o)}},n.prototype.load=function(t){t.hash&&this.parseHash(t.hash),t.query&&this.parseQuery(t.query),t.env&&this.parseEnv(t.env),t.argv&&this.parseArg(t.argv),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.open=function(t){if(d.unsupported)return;const e=this.getFile(t);let o;try{o=d.readFileSync(e,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseConfig(o),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.set=function(t,e){c("string"==typeof t,"Key must be a string."),null!=e&&(t=(t=t.replace(/-/g,"")).toLowerCase(),this.options[t]=e)},n.prototype.has=function(t){return"number"==typeof t?(c(t>=0,"Index must be positive."),!(t>=this.argv.length)):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]||(null!=this.query[t]||(null!=this.args[t]||(null!=this.env[t]||(null!=this.data[t]||null!=this.options[t])))))},n.prototype.get=function(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const o=t;for(const t of o){const e=this.get(t);if(null!==e)return e}return e}return"number"==typeof t?(c(t>=0,"Index must be positive."),t>=this.argv.length?e:null!=this.argv[t]?this.argv[t]:e):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]?this.hash[t]:null!=this.query[t]?this.query[t]:null!=this.args[t]?this.args[t]:null!=this.env[t]?this.env[t]:null!=this.data[t]?this.data[t]:null!=this.options[t]?this.options[t]:e)},n.prototype.typeOf=function(t){const e=this.get(t);return null===e?"null":typeof e},n.prototype.str=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o)throw new Error(`${i(t)} must be a string.`);return o},n.prototype.int=function(t,e){let o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if("number"!=typeof o)throw new Error(`${i(t)} must be an int.`);if(!Number.isSafeInteger(o))throw new Error(`${i(t)} must be an int.`);return o}if(!/^\-?\d+$/.test(o))throw new Error(`${i(t)} must be an int.`);if(o=parseInt(o,10),!Number.isSafeInteger(o))throw new Error(`${i(t)} must be an int.`);return o},n.prototype.uint=function(t,e){const o=this.int(t);if(void 0===e&&(e=null),null===o)return e;if(o<0)throw new Error(`${i(t)} must be a uint.`);return o},n.prototype.float=function(t,e){let o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if("number"!=typeof o)throw new Error(`${i(t)} must be a float.`);if(!isFinite(o))throw new Error(`${i(t)} must be a float.`);return o}if(!/^\-?\d*(?:\.\d*)?$/.test(o))throw new Error(`${i(t)} must be a float.`);if(!/\d/.test(o))throw new Error(`${i(t)} must be a float.`);if(o=parseFloat(o),!isFinite(o))throw new Error(`${i(t)} must be a float.`);return o},n.prototype.ufloat=function(t,e){const o=this.float(t);if(void 0===e&&(e=null),null===o)return e;if(o<0)throw new Error(`${i(t)} must be a positive float.`);return o},n.prototype.fixed=function(t,e,o){const n=this.float(t);if(void 0===o&&(o=null),null===n)return o;try{return f.fromFloat(n,e||0)}catch(e){throw new Error(`${i(t)} must be a fixed number.`)}},n.prototype.ufixed=function(t,e,o){const n=this.fixed(t,e);if(void 0===o&&(o=null),null===n)return o;if(n<0)throw new Error(`${i(t)} must be a positive fixed number.`);return n},n.prototype.bool=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("number"==typeof o){if(1===o)return!0;if(0===o)return!1}if("string"!=typeof o){if("boolean"!=typeof o)throw new Error(`${i(t)} must be a boolean.`);return o}if("true"===o||"1"===o)return!0;if("false"===o||"0"===o)return!1;throw new Error(`${i(t)} must be a boolean.`)},n.prototype.buf=function(t,e,o){const n=this.get(t);if(o||(o="hex"),void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if(!Buffer.isBuffer(n))throw new Error(`${i(t)} must be a buffer.`);return n}const s=Buffer.from(n,o);if(s.length!==Buffer.byteLength(n,o))throw new Error(`${i(t)} must be a ${o} string.`);return s},n.prototype.array=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("string"!=typeof o){if(!Array.isArray(o))throw new Error(`${i(t)} must be an array.`);return o}const n=o.trim().split(/\s*,\s*/),s=[];for(const t of n)0!==t.length&&s.push(t);return s},n.prototype.obj=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("object"!=typeof o)throw new Error(`${i(t)} must be an object.`);return o},n.prototype.func=function(t,e){const o=this.get(t);if(void 0===e&&(e=null),null===o)return e;if("function"!=typeof o)throw new Error(`${i(t)} must be a function.`);return o},n.prototype.path=function(t,e){let o=this.str(t);if(void 0===e&&(e=null),null===o)return e;switch(o[0]){case"~":o=h.join(g,o.substring(1));break;case"@":o=h.join(this.prefix,o.substring(1))}return h.normalize(o)},n.prototype.mb=function(t,e){const o=this.uint(t);return void 0===e&&(e=null),null===o?e:1024*o*1024},n.prototype.getNetwork=function(){let t=this.str("network");return t||(t="mainnet"),c(r(t),"Bad network."),t},n.prototype.getPrefix=function(){let t=this.str("prefix");if(t)return"~"===t[0]&&(t=h.join(g,t.substring(1))),t;t=h.join(g,`.${this.module}`);const e=this.str("network");return e&&(c(r(e),"Bad network."),"mainnet"!==e&&(t=h.join(t,e))),h.normalize(t)},n.prototype.getFile=function(t){const e=this.str("config");return e||h.join(this.prefix,t)},n.prototype.ensure=function(){return d.unsupported?Promise.resolve():d.mkdirp(this.prefix)},n.prototype.location=function(t){return h.join(this.prefix,t)},n.prototype.write=function(t,e){d.writeFileSync(this.location(t),e)},n.prototype.parseConfig=function(t){c("string"==typeof t,"Config must be text."),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\\\n/g,"");let e=!0,o=!1,i=0;for(const s of t.split("\n")){const t=s.trim();if(i+=1,0===t.length)continue;if("#"===t[0])continue;const r=t.indexOf("="),a=t.indexOf(":");let c=-1;if(-1!==a&&(a<r||-1===r)){if(o&&!e)throw new Error(`Expected '=' on line ${i}: "${t}".`);c=a,o=!0,e=!0}else{if(-1===r){const o=e?":":"=";throw new Error(`Expected '${o}' on line ${i}: "${t}".`)}if(o&&e)throw new Error(`Expected ':' on line ${i}: "${t}".`);c=r,o=!0,e=!1}let h=t.substring(0,c).trim();if(h=h.replace(/\-/g,""),!l(h))throw new Error(`Invalid option on line ${i}: ${h}.`);const p=t.substring(c+1).trim();if(0===p.length)continue;const u=n.alias[h];u&&(h=u),this.data[h]=p}},n.prototype.parseArg=function(t){t&&"object"==typeof t||(t=process.argv),c(Array.isArray(t));let e=null,o=!1;for(let i=2;i<t.length;i++){const s=t[i];if(c("string"==typeof s),"--"===s){o=!0;continue}if(o){this.pass.push(s);continue}if(0===s.length){e=null;continue}if(0===s.indexOf("--")){const t=s.indexOf("=");let o=null,i=null,r=!1;if(-1!==t?(o=s.substring(2,t),i=s.substring(t+1),e=null,r=!1):(o=s.substring(2),i="true",e=null,r=!0),o=o.replace(/\-/g,""),!l(o))throw new Error(`Invalid argument: --${o}.`);if(0===i.length)continue;if(o.length>1){const t=n.alias[o];t&&(o=t)}this.args[o]=i,r&&(e=o);continue}if("-"===s[0]){e=null;for(let t=1;t<s.length;t++){let o=s[t];if((o<"a"||o>"z")&&(o<"A"||o>"Z")&&(o<"0"||o>"9")&&"?"!==o)throw new Error(`Invalid argument: -${o}.`);const i=n.alias[o];i&&(o=i),this.args[o]="true",e=o}continue}const r=s;0!==r.length?e?(this.args[e]=r,e=null):this.argv.push(r):e=null}},n.prototype.parseEnv=function(t){let e=this.module;e=(e=e.toUpperCase()).replace(/-/g,"_"),e+="_",t&&"object"==typeof t||(t=process.env),c(t&&"object"==typeof t);for(let o of Object.keys(t)){const i=t[o];if(c("string"==typeof i),f.startsWith(o,e)&&(o=o.substring(e.length),o=o.replace(/_/g,""),function(t){return!!a(t)&&!/[a-z]/.test(t)}(o)&&0!==i.length)){if((o=o.toLowerCase()).length>1){const t=n.alias[o];t&&(o=t)}this.env[o]=i}}},n.prototype.parseQuery=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.search))return{}}return this.parseForm(t,this.query)},n.prototype.parseHash=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.hash))return{}}return this.parseForm(t,this.hash)},n.prototype.parseForm=function(t,e){if(c("string"==typeof t),0===t.length)return;let o="?";e===this.hash&&(o="#"),t[0]===o&&(t=t.substring(1));for(const o of t.split("&")){const t=o.indexOf("=");let i,r;if(-1!==t?(i=o.substring(0,t),r=o.substring(t+1)):(i=o,r="true"),i=s(i),i=i.replace(/\-/g,""),!l(i))continue;if(0===(r=s(r)).length)continue;const a=n.alias[i];a&&(i=a),e[i]=r}},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);r.call(this),this.config=new u("wmcc"),this.config.inject(t),this.config.load(t),t.config&&this.config.open("wmcc.conf"),this.network=l.get(this.config.network),this.startTime=-1,this.bound=[],this.plugins=Object.create(null),this.stack=[],this.logger=null,this.workers=null,this.spv=!1,this.chain=null,this.fees=null,this.mempool=null,this.pool=null,this.miner=null,this.http=null,this.wallet=null,this.stratum=null,this.init()}const i=o(1),s=o(0),{AsyncObject:r,util:a}=s.utils,{Network:l}=s.protocol,{WorkerPool:c}=s.workers,{secp256k1:h}=s.crypto,p=s.native,u=o(3),d=o(5);Object.setPrototypeOf(n.prototype,r.prototype),n.prototype.initOptions=function(){let t=new d;const e=this.config;e.has("logger")&&(t=e.obj("logger")),t.set({filename:e.bool("log-file")?e.location("debug.log"):null,level:e.str("log-level"),console:e.bool("log-console"),browser:e.bool("log-browser"),shrink:e.bool("log-shrink")}),this.logger=t.context("node"),this.workers=new c({enabled:e.bool("workers"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout"),file:e.str("worker-file")})},n.prototype.init=function(){this.initOptions(),this.on("error",()=>{}),this.workers.on("spawn",t=>{this.logger.info("Spawning worker process: %d.",t.id)}),this.workers.on("exit",(t,e)=>{this.logger.warning("Worker %d exited: %s.",e.id,t)}),this.workers.on("log",(t,e)=>{this.logger.debug("Worker %d says:",e.id),this.logger.debug(t)}),this.workers.on("error",(t,e)=>{e?this.logger.error("Worker %d error: %s",e.id,t.message):this.emit("error",t)}),this.hook("preopen",()=>this.handlePreopen()),this.hook("preclose",()=>this.handlePreclose()),this.hook("open",()=>this.handleOpen()),this.hook("close",()=>this.handleClose())},n.prototype.ensure=function(){return this.config.ensure()},n.prototype.location=function(t){return this.config.location(t)},n.prototype.handlePreopen=async function(){await this.logger.open(),await this.workers.open(),this.bind(this.network.time,"offset",t=>{this.logger.info("Time offset: %d (%d minutes).",t,t/60|0)}),this.bind(this.network.time,"sample",(t,e)=>{this.logger.debug("Added time data: samples=%d, offset=%d (%d minutes).",e,t,t/60|0)}),this.bind(this.network.time,"mismatch",()=>{this.logger.warning("Adjusted time mismatch!"),this.logger.warning("Please make sure your system clock is correct!")})},n.prototype.handleOpen=async function(){this.startTime=a.now(),h.binding||(this.logger.warning("Warning: secp256k1-node was not built."),this.logger.warning("Verification will be slow.")),p.binding||(this.logger.warning("Warning: wmcc-native was not built."),this.logger.warning("Hashing will be slow.")),this.workers.enabled||(this.logger.warning("Warning: worker pool is disabled."),this.logger.warning("Verification will be slow."))},n.prototype.handlePreclose=async function(){},n.prototype.handleClose=async function(){for(const[t,e,o]of this.bound)t.removeListener(e,o);this.bound.length=0,this.startTime=-1,await this.workers.close(),await this.logger.close()},n.prototype.bind=function(t,e,o){this.bound.push([t,e,o]),t.on(e,o)},n.prototype.error=function(t){this.logger.error(t),this.emit("error",t)},n.prototype.uptime=function(){return-1===this.startTime?0:a.now()-this.startTime},n.prototype.use=function(t){i(t,"Plugin must be an object."),i("function"==typeof t.init,"`init` must be a function."),i(!this.loaded,"Cannot add plugin after node is loaded.");const e=t.init(this,s);if(i(!e.open||"function"==typeof e.open,"`open` must be a function."),i(!e.close||"function"==typeof e.close,"`close` must be a function."),t.id){switch(i("string"==typeof t.id,"`id` must be a string."),t.id){case"chain":case"fees":case"mempool":case"miner":case"pool":case"rpc":case"http":case"wallet":case"stratum":i(!1,`${t.id} is already added.`)}i(!this.plugins[t.id],`${t.id} is already added.`),this.plugins[t.id]=e}return this.stack.push(e),"function"==typeof e.on&&e.on("error",t=>this.error(t)),e},n.prototype.has=function(t){return null!=this.plugins[t]},n.prototype.get=function(t){switch(i("string"==typeof t,"Plugin name must be a string."),t){case"chain":return i(this.chain,"chain is not loaded."),this.chain;case"fees":return i(this.fees,"fees is not loaded."),this.fees;case"mempool":return i(this.mempool,"mempool is not loaded."),this.mempool;case"miner":return i(this.miner,"miner is not loaded."),this.miner;case"pool":return i(this.pool,"pool is not loaded."),this.pool;case"rpc":return i(this.rpc,"rpc is not loaded."),this.rpc;case"http":return i(this.http,"http is not loaded."),this.http;case"wallet":return i(this.wallet,"wallet is not loaded."),this.wallet;case"stratum":return i(this.stratum,"stratum is not loaded."),this.stratum}return this.plugins[t]||null},n.prototype.require=function(t){const e=this.get(t);return i(e,`${t} is not loaded.`),e},n.prototype.loadPlugins=function(){const t=this.config.array("plugins",[]),e=this.config.func("loader");for(let o of t)"string"==typeof o&&(i(e,"Must pass a loader function."),o=e(o)),this.use(o)},n.prototype.openPlugins=async function(){for(const t of this.stack)t.open&&await t.open()},n.prototype.closePlugins=async function(){for(const t of this.stack)t.close&&await t.close()},t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.level=n.levels.NONE,this.colors=n.HAS_TTY,this.console=!0,this.browser=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),this.locker=new p,t&&this.set(t)}function i(t,e){if(!(this instanceof i))return new i(t,e);r("string"==typeof e),this.logger=t,this.module=e}function s(t){return new Promise((e,o)=>{const n=l.createWriteStream(t,{flags:"a"}),i=()=>{n.removeListener("error",s),n.removeListener("open",r)},s=t=>{try{n.close()}catch(t){}i(),o(t)},r=()=>{i(),e(n)};n.once("error",s),n.once("open",r)})}const r=o(1),a=o(0),{fs:l,util:c,co:h,Lock:p}=a.utils;n.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),n.MAX_FILE_SIZE=20<<20,n.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},n.levelsByVal=["none","error","warning","info","debug","spam"],n.prefixByVal=["N","E","W","I","D","S"],n.styles=["0","1;31","1;33","94","90","90"],n.prototype.set=function(t){r(t),r(this.closed),"string"!=typeof t?(null!=t.level&&(r("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&n.HAS_TTY&&(r("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(r("boolean"==typeof t.console),this.console=t.console),null!=t.browser&&(r("boolean"==typeof t.browser),this.browser=t.browser),null!=t.shrink&&(r("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(r("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)},n.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},n.prototype._open=async function(){this.filename?this.stream?this.closed=!1:l.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await s(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1},n.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},n.prototype._close=async function(){if(null!=this.timer&&(h.clearTimeout(this.timer),this.timer=null),l.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await function(t){return new Promise((e,o)=>{const n=()=>{t.removeListener("error",i),t.removeListener("close",s)},i=t=>{n(),o(t)},s=()=>{n(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",i),t.once("close",s),t.close()})}(this.stream)}finally{this.closing=!1}this.stream=null}this.closed=!0},n.prototype.truncate=async function(){if(!this.filename)return;if(l.unsupported)return;r(!this.stream);let t;try{t=await l.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const e=n.MAX_FILE_SIZE;if(t.size<=e+e/10)return;this.debug("Truncating log file to %d bytes.",e);const o=await l.open(this.filename,"r+"),i=Buffer.allocUnsafe(e);await l.read(o,i,0,e,t.size-e),await l.ftruncate(o,e),await l.write(o,i,0,e,0),await l.close(o)},n.prototype.handleError=function(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()},n.prototype.reopen=async function(){const t=await this.locker.lock();try{return await this._reopen()}finally{t()}},n.prototype._reopen=async function(){if(!this.stream&&!this.closed&&!l.unsupported){try{this.stream=await s(this.filename)}catch(t){return void this.retry()}this.stream.once("error",this.handleError.bind(this))}},n.prototype.retry=function(){r(null==this.timer),this.timer=h.setTimeout(()=>{this.timer=null,this.reopen()},1e4,this)},n.prototype.setFile=function(t){r("string"==typeof t),r(!this.stream,"Log stream has already been created."),this.filename=t},n.prototype.setLevel=function(t){const e=n.levels[t.toUpperCase()];r(null!=e,"Invalid log level."),this.level=e},n.prototype.error=function(...t){if(this.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,null,e):this.log(n.levels.ERROR,null,t)},n.prototype.warning=function(...t){if(this.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,null,e):this.log(n.levels.WARNING,null,t)},n.prototype.info=function(...t){if(this.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,null,e):this.log(n.levels.INFO,null,t)},n.prototype.debug=function(...t){if(this.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,null,e):this.log(n.levels.DEBUG,null,t)},n.prototype.spam=function(...t){if(this.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,null,e):this.log(n.levels.SPAM,null,t)},n.prototype.log=function(t,e,o){this.closed||this.level<t||(this.writeConsole(t,e,o),this.writeBrowser(t,e,o),this.writeStream(t,e,o))},n.prototype.context=function(t){let e=this.contexts[t];return e||(e=new i(this,t),this.contexts[t]=e),e},n.prototype.writeConsole=function(t,e,o){const i=n.levelsByVal[t];if(r(i,"Invalid log level."),!this.console)return!1;if(!process.stdout){let s=`[${i}] `;return e&&(s+=`(${e}) `),"object"==typeof o[0]?t===n.levels.ERROR?console.error(s,o[0]):console.log(s,o[0]):(s+=c.format(o,!1),t===n.levels.ERROR?(console.error(s),!0):(console.log(s),!0))}let s;if(this.colors){const e=n.styles[t];r(e),s=`[${e}m[${i}][m `}else s=`[${i}] `;return e&&(s+=`(${e}) `),s+=c.format(o,this.colors),s+="\n",t===n.levels.ERROR?process.stderr.write(s):process.stdout.write(s)},n.prototype.writeBrowser=function(t,e,o){const i=n.levelsByVal[t];if(r(i,"Invalid log level."),!this.browser)return!1;let s=`[${i}] `;return e&&(s+=`(${e}) `),"object"==typeof o[0]?t===n.levels.ERROR?console.error(s,o[0]):console.log(s,o[0]):(s+=c.format(o,!1),t===n.levels.ERROR?(console.error(s),!0):("net"!==e&&console.log(s),!0))},n.prototype.writeStream=function(t,e,o){const i=n.prefixByVal[t];if(r(i,"Invalid log level."),!this.stream)return;if(this.closing)return;let s=`[${i}:${c.date()}] `;e&&(s+=`(${e}) `),s+=c.format(o,!1),s+="\n",this.stream.write(s)},n.prototype.logError=function(t,e,o){if(this.closed)return;l.unsupported&&this.console&&t<=n.levels.WARNING&&console.error(o);let i=String(o.message).replace(/^ *Error: */,"");t!==n.levels.ERROR&&(i=`Error: ${i}`),this.log(t,e,[i]),t<=n.levels.WARNING&&this.stream&&this.stream.write(o.stack+"\n")},n.prototype.memory=function(t){const e=c.memoryUsage();this.log(n.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])},i.prototype.open=function(){return this.logger.open()},i.prototype.close=function(){return this.logger.close()},i.prototype.setFile=function(t){this.logger.setFile(t)},i.prototype.setLevel=function(t){this.logger.setLevel(t)},i.prototype.error=function(...t){if(this.logger.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,e):this.log(n.levels.ERROR,t)},i.prototype.warning=function(...t){if(this.logger.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,e):this.log(n.levels.WARNING,t)},i.prototype.info=function(...t){if(this.logger.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,e):this.log(n.levels.INFO,t)},i.prototype.debug=function(...t){if(this.logger.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,e):this.log(n.levels.DEBUG,t)},i.prototype.spam=function(...t){if(this.logger.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,e):this.log(n.levels.SPAM,t)},i.prototype.log=function(t,e){this.logger.log(t,this.module,e)},i.prototype.context=function(t){return new i(this.logger,t)},i.prototype.logError=function(t,e){this.logger.logError(t,this.module,e)},i.prototype.memory=function(){this.logger.memory(this.module)},n.global=new n,t.exports=n},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),this.node=t,this.network=t.network,this.filter=null,this.listen=!1,this._init()}const i=o(0),{AsyncObject:s}=i.utils;Object.setPrototypeOf(n.prototype,s.prototype),n.prototype._init=function(){this.node.on("connect",(t,e)=>{this.listen&&this.emit("block connect",t,e.txs)}),this.node.on("disconnect",(t,e)=>{this.listen&&this.emit("block disconnect",t)}),this.node.on("tx",t=>{this.listen&&this.emit("tx",t)}),this.node.on("reset",t=>{this.listen&&this.emit("chain reset",t)})},n.prototype._open=function(t){return this.listen=!0,Promise.resolve()},n.prototype._close=function(){return this.listen=!1,Promise.resolve()},n.prototype.getTip=function(){return Promise.resolve(this.node.chain.tip)},n.prototype.getEntry=async function(t){const e=await this.node.chain.getEntry(t);return e&&await this.node.chain.isMainChain(e)?e:null},n.prototype.send=function(t){return this.node.relay(t),Promise.resolve()},n.prototype.setFilter=function(t){return this.filter=t,this.node.pool.setFilter(t),Promise.resolve()},n.prototype.addFilter=function(t){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.resetFilter=function(){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.estimateFee=async function(t){return this.node.fees?this.node.fees.estimateFee(t):this.network.feeRate},n.prototype.rescan=function(t){return this.node.chain.scan(t,this.filter,(t,e)=>this.fire("block rescan",t,e))},t.exports=n},function(module,exports,__webpack_require__){"use strict";function Info(t){if(!(this instanceof Info))return new Info(t);this.info=null,this.node=t,this.wallet=t.wallet||null,this.account=t.wallet?t.wallet.account:null,this.explorer={isHome:!0}}function toDifficulty(t){let e=t>>>24&255,o=65535/(16777215&t);for(;e<29;)o*=256,e++;for(;e>29;)o/=256,e--;return o.toFixed(12)}function substract(t,e,o=8){const n=Math.pow(10,o);return(t*n-e*n).toFixed(0)/n}function sum(t,e,o=8){const n=Math.pow(10,o);return(t*n+e*n).toFixed(0)/n}function compare(t,e){const o=t.time?t.time:t.mtime,n=e.time?e.time:e.mtime;return o<n?1:n<o?-1:0}function toTxTable(t,e){let o="",n=!1;if(Object.keys(t.input).length)for(let i in t.input)i===e?(o+=`<div><span>${i}</span>`,n=!0):t.pending.includes(i)?o+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i>\n          <span class='red address r_goToExp' title='Output from unconfirmed transaction'>${i}</span>`:o+=`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${i}</span>`,o+=`<span class='value'>${Amount.wmcc(t.input[i],!0)} wmcc</span></div>`;else o+="<div><span class='coinbase'>No Inputs (Newly Generated Coins)</span></div>";o+=`</td><td><i class="glyph-icon flaticon-${n?"out red":"in green"}"></i></td><td>`;for(let n in t.output)o+="<div>",o+="unknown"===n?"<a class='unparsed'>Unparsed output address</a>":n===e?`<div><i class="glyph-icon flaticon-copy next" title="Copy"></i><span>${n}</span>`:`<i class="glyph-icon flaticon-copy next" title="Copy"></i><span class='address r_goToExp'>${n}</span>`,o+=`<span class='value'>${Amount.wmcc(t.output[n],!0)} wmcc</span></div>`;return o}function page(t,e,o,n){let i="";const s=e-o,r=e+o,a=parseInt(e/o+1),l=Math.ceil(t/o),{start:c,end:h}=median(a,l,10);i+=`<div class="page"><a ${0===e?'class="disable"':'class="'+n+'" offset="'+s+'" limit="'+o+'"'}>&#9668;</a>`;for(let t=c;t<h;t++)i+=`<a ${a===t+1?'class="active"':'class="'+n+'" offset="'+o*t+'" limit="'+o+'"'}>${t+1}</a>`;return i+=`<a ${r+1>t?'class="disable"':'class="'+n+'" offset="'+r+'" limit="'+o+'"'}>&#9658;</a></div>`}function age(t,e){let o=e?t:Math.abs(Date.now()/1e3-t),n="",i={},s=0;const r={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60,second:1};return Object.keys(r).forEach(function(t){i[t]=Math.floor(o/r[t]),o-=i[t]*r[t],i[t]&&s<2&&(s++,n+=` ${i[t]} ${t}${i[t]>1?"s":""}`)}),`${n}${e?"":" ago"}`}function filtermeta(t){return t.filter(function(t,e,o){return o[e].tx._hhash!==t.tx._hhash})}function filtermeta(t){let e=[];return t.filter(function(t){return-1===e.indexOf(t.tx._hhash)&&(e.push(t.tx._hhash),!0)})}function median(t,e,o){let n=Math.max(0,t-o/2);const i=Math.min(n+o,e);return n=Math.max(0,Math.min(i-o,i)),{start:n,end:i}}const Core=__webpack_require__(0),{Address:Address}=Core.primitives,{Account:Account}=Core.wallet,{Amount:Amount}=Core.wmcc,{encoding:encoding,util:util}=Core.utils,{consensus:consensus,policy:policy}=Core.protocol;Info.prototype.getWalletID=function(){return this.wallet.id},Info.prototype.getAccounts=function(){return this.wallet.getAccounts()},Info.prototype.getAccount=function(){return this.wallet.account},Info.prototype.getAccountName=function(){return this.wallet.account.name},Info.prototype.getTempReceive=function(){return this.wallet.getTempReceive().toString()},Info.prototype.createReceive=async function(){const t=await this.getAccountName();await this.wallet.createReceive(t);return this.getTempReceive()},Info.prototype.estimateFee=async function(){let t=await this.node.walletdb.estimateFee();return Amount.wmcc(t)},Info.prototype.estimatePri=async function(){let t=await this.node.fees.estimatePriority();return 0===t&&(t=this.node.fees.minTrackedPri),Amount.wmcc(t)},Info.prototype.isMinerStarted=function(){return this.node.miner.cpu.running},Info.prototype.startMining=async function(){try{return await this.node.miner.cpu.start()}catch(t){}},Info.prototype.stopMining=async function(){try{return await this.node.miner.cpu.stop()}catch(t){this.node.miner.reset(!1)}},Info.prototype.getAddress=function(){return this.node.miner.getAddress().toString()},Info.prototype.getWalletInfo=async function(){let t="";const e=this.wallet.toJSON(!0);return t+=`<holder><i class="glyph-icon flaticon-wallets"></i><span>${e.id} <a>Wallet Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-id"></i><span>${e.wid} <a>Wallet ID</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account"></i><span>${e.account.name} <a>Account Name</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-account-lock"></i><span>${e.account.type.toUpperCase()} <a>Account Type</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-swap"></i><span>${e.state.tx} <a>Number of Transactions</a></span></holder>`,t+=`<holder><i class="glyph-icon flaticon-network"></i><span>${e.network.toUpperCase()} <a>Network</a></span></holder>`},Info.prototype.getWalletDetails=async function(){let t="<table>";const e=this.wallet.toJSON(!0),o=e.account.accountKey,{tx:n,coin:i,confirmed:s,unconfirmed:r}=e.state;return t+=`<tr><td>Wallet Name</td><td colspan="2">${e.id}</td></tr>`,t+=`<tr><td>Wallet ID</td><td colspan="2">${e.wid}</td></tr>`,t+=`<tr><td>Wallet Key</td><td>${e.chksum.toString("hex")}★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-copy" title="Copy"></i></td></tr>',t+=`<tr><td>Token</td><td title="${e.token}">${e.token.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${e.token}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Name</td><td colspan="2">${e.account.name}</td></tr>`,t+=`<tr><td>Account Public Key</td><td title="${o}">${o.slice(0,32)}...</td>`,t+=`<td><i class="glyph-icon flaticon-copy" value="${o}" title="Copy"></i></td></tr>`,t+=`<tr><td>Account Type</td><td colspan="2">${e.account.type.toUpperCase()}</td></tr>`,t+=`<tr><td>Number of Transactions</td><td colspan="2">${n}</td></tr>`,t+=`<tr><td>Number of Coins</td><td colspan="2">${i}</td></tr>`,t+=`<tr><td>Confirm Balance</td><td colspan="2">${Amount.wmcc(s,!0)} wmcc</td></tr>`,t+=`<tr><td>Unconfirm Balance</td><td colspan="2">${Amount.wmcc(r,!0)} wmcc</td></tr>`,t+=`<tr><td>Network</td><td colspan="2">${e.network.toUpperCase()}</td></tr>`,t+=`<tr><td>Watch Only</td><td colspan="2">${e.watchOnly.toString().toUpperCase()}</td></tr>`,t+="</table>"},Info.prototype.getWalletHistory=async function(t,e){t=parseInt(t)||10,e=parseInt(e)||0;const o=await this.wallet.getTransactions(this.wallet.account.name,t,e);return await this.getWalletHistoryTable(o,{limit:t,offset:e})},Info.prototype.getWalletHistoryTable=async function(t,e){if(0===t.length)return`<h2>No transactions found in wallet <span>${this.wallet.id}</span> for account <span>${this.wallet.account.name}.</span></h2>`;let o="<table><tr><th>Date/Time</th><th>Status</th><th>Height</th><th>Transactions Hash</th><th>Value</th></tr>";for(let n=0;n<t.length;n++){const i=new Date(1e3*t[n].mtime).format("M j, Y, g:i a");let s;let r=0,a=!1;if(t[n].inputs[0].address)for(let e=0;e<t[n].inputs.length;e++)t[n].inputs[e].path&&(r+=t[n].inputs[e].value,a=!0,s="Sent",0===t[n].time&&(s="Sending"));for(let o=0;o<t[n].outputs.length;o++)if(t[n].outputs[o].path){if(a?r-=t[n].outputs[o].value:r+=t[n].outputs[o].value,s)continue;s="Received",0===t[n].time&&(s="Receiving"),t[n].tx.isCoinbase()&&(s=e.pending?"Staled":"Mined")}let l=0;try{l=Amount.wmcc(r)}catch(e){console.log(e),console.log(t[n]),console.log(r),l="unknown"}o+="<tr>",o+=`<td>${i}</td>`,o+=`<td>${s}</td>`,t[n].block?o+=`<td title="${util.revHex(t[n].block)}"><a class='r_goToExp'>${t[n].height}</a></td>`:o+="<td>N/A</td>",o+=`<td title="${t[n].hash}"><a class='r_goToExp'>${t[n].hash}</a></td>`,o+=`<td>${l}</td>`,o+="</tr>"}if(o+="</table>",!e.limit)return o;const n=await this.wallet.getPending(this.wallet.account.name);return o+=page(await this.wallet.getTotal(this.wallet.account.name)-n.length,e.offset,e.limit,"r_walletGetHistory")},Info.prototype.getWalletPendingTx=async function(){const t=await this.wallet.getPendingDetails(this.wallet.account.name);return await this.getWalletHistoryTable(t,{pending:!0})},Info.prototype.setGenSearchAddress=async function(t){let e="",o=null;try{o=Address.fromString(t)}catch(o){return e+='<div class="error"><h2>Opps! Invalid address format</h2><span>',e+=`<a>${t}</a> is not a valid WMCC Address.<br>Please check and try again.</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>'}if(!await this.wallet.getPath(o))return e+='<div class="error"><h2>Opps! Address not found</h2><span>Cannot find <a>',e+=`${t}</a> in this wallet (<a>${this.wallet.id}</a>).</span>`,e+='<submit class="button r_genGotoAddresses">BACK</submit></div>';await this.setExpAddress(t);const{metatx:n,coins:i}=this.explorer.details;let s=0;for(let t of i)s+=t.value;let r=0;for(let t of n)for(let e of t.tx.outputs){let t=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);o.hash.equals(t)&&(r+=e.value)}const a=$('<div id="qrcode"></div>').qrcode(o.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png"),l=n.length?`<i class="glyph-icon flaticon-record r_goToExp" value=${t} title="View Transactions"></i>`:"";return e+=`<div class="address"><img src="${a}"/><h2>Your WMCC Address</h2><table>`,e+=`<tr><td>Number of Transactions</td><td><span>${n.length}${l}</span></td></tr>`,e+=`<tr><td>Total Received</td><td><span>${Amount.wmcc(r,!0)} wmcc</span></td></tr>`,e+=`<tr><td>Address Hash 160</td><td><span class='address'>${o.hash.toString("hex")}</span></td></tr>`,e+=`<tr><td>Final Balance</td><td><span>${Amount.wmcc(s,!0)} wmcc</span></td></tr>`,e+="</table>",e+=`<p><a>This is Your WMCC Address.</a><a class="address">${t}</a>`,e+="<a>Share this with anyone so they can send you wmcoins.</a>",e+='<submit class="button r_genGotoAddresses">BACK</submit></p></div>'},Info.prototype.getGenAddress=async function(t=10,e=0){t=parseInt(t)||10,e=parseInt(e)||0;let o="<table><tr><th>Type</th><th>Address</th><th>Hash 160</th><th></th></tr>";const n=await this.wallet.getAccountPaths(this.wallet.account.name),i=t+e>n.length?n.length:e+t;for(let t=e;t<i;t++){const e=n[t].toAddress();o+=`<tr><td>${e.getType()}</td><td><a class='r_genGotoAddress' title='${e}'>${e}</a></td>`,o+=`<td><a title='${n[t].hash}'>${n[t].hash}</a></td>`,o+=`<td><i class="glyph-icon flaticon-copy r_genCopyAddress" value="${e}" title="Copy to clipboard"></i>`,o+='<i class="glyph-icon flaticon-gear r_walletManageAddress" title="Manage address"></i></td></tr>'}o+="</table>";return o+=page(n.length,e,t,"r_genGotoAddresses")},Info.prototype.getExpLatestBlocks=async function(t=5){if(!this.explorer.isHome)return"";const e=this.node.chain.height,o=parseInt(t);let n="<h1>Latest Blocks</h1><table class='home'><tr><th>Height</th><th>Age</th><th>Transactions</th><th>Total Output (wmcc)</th><th>Size (kb)</th><th>Weight (kwu)</th></tr>";for(let t=e;t>e-o&&t>-1;t--){const e=await this.node.chain.getEntry(t),o=await this.node.chain.getBlock(e.hash);n+=`<tr><td class='block r_goToExp'>${e.height}</td>`,n+=`<td>${age(e.time)}</td>`,n+=`<td>${o.txs.length}</td>`,n+=`<td>${Amount.wmcc(o.getClaimed())}</td>`,n+=`<td>${o.getVirtualSize()/1e3}</td>`,n+=`<td>${o.getWeight()/1e3}</td></tr>`}return n+="</table>"},Info.prototype.getExpLatestTransaction=async function(t=10){if(!this.explorer.isHome)return"";let e="<h1>Latest Transactions</h1>";if(!this.node.mempool.map.size)return e+'<h2 class="empty">No latest transaction found.</h2>';const o=parseInt(t);let n=0;return e+="<table class='home'><tr><th>Transaction Hash</th><th>Size (bytes)</th><th>Value (wmcc)</th></tr>",this.node.mempool.map.forEach((t,i)=>{o>n&&(e+=`<tr><td class='tx r_goToExp'>${i}</td>`,e+=`<td>${t.size}</td>`,e+=`<td>${Amount.wmcc(t.value,!0)}</td></tr>`,n++)}),e+="</table>"},Info.prototype.setExpBlockByHeight=async function(t){try{const e=parseInt(t,10),o=await this.node.chain.getEntry(e),n=await this.node.chain.getBlock(o.hash);return this.explorer.details={entry:o,block:n},o.height||!1}catch(t){return!1}},Info.prototype.setExpBlockByHash=async function(t){try{const e=await this.node.chain.getEntry(util.revHex(t)),o=await this.node.chain.getBlock(util.revHex(t));return this.explorer.details={entry:e,block:o},e.rhash()||!1}catch(t){return!1}},Info.prototype.getExpBlockByHeight=function(t){const{entry:e}=this.explorer.details;return e?e.height:this.setExpBlockByHeight(t||this.node.chain.tip.height)},Info.prototype.getExpHash=function(){return this.explorer.details.entry.rhash()},Info.prototype.getExpPrevHash=function(){const{entry:t}=this.explorer.details;return t.prevBlock!==encoding.NULL_HASH?util.revHex(t.prevBlock):null},Info.prototype.getExpNextHash=async function(){const{entry:t}=this.explorer.details,e=await this.node.chain.getNextHash(t.hash);return e?util.revHex(e):null},Info.prototype.getExpMerkleRoot=function(){const{entry:t}=this.explorer.details;return util.revHex(t.merkleRoot)},Info.prototype.getExpChainwork=function(){const{entry:t}=this.explorer.details;return t.chainwork.toString("hex",64)},Info.prototype.getExpTxCount=function(){const{block:t}=this.explorer.details;return t.txs.length},Info.prototype.getExpHeight=function(){return this.explorer.details.entry.height},Info.prototype.getExpTimestamp=function(){const{entry:t}=this.explorer.details;return`${new Date(1e3*t.time).format("F j, Y, h:i:s A")}`},Info.prototype.getExpDifficulty=function(){return toDifficulty(this.getExpBits())},Info.prototype.getExpBits=function(){return this.explorer.details.entry.bits},Info.prototype.getExpNonce=function(){return this.explorer.details.entry.nonce},Info.prototype.getExpConfirmation=function(){const{entry:t}=this.explorer.details;return this.node.chain.height-t.height+1},Info.prototype.getExpVersion=function(){const{entry:t}=this.explorer.details;return`0x${util.hex32(t.version)}`},Info.prototype.getExpSize=function(){const{block:t}=this.explorer.details;return`${t.getVirtualSize()} bytes`},Info.prototype.getExpWeight=function(){const{block:t}=this.explorer.details;return`${t.getWeight()} bytes`},Info.prototype.getExpTotalOut=function(){const{txs:t}=this.explorer.details.block;let e=0;for(let o of t)for(let t of o.outputs)e+=t.value;return`${Amount.wmcc(e,!0)} wmcc`},Info.prototype.getExpFee=function(){const{txs:t}=this.explorer.details.block,{height:e}=this.explorer.details.entry;if(0===e)return"0 wmcc";for(let o of t)if(o.isCoinbase()){const t=consensus.getReward(e),n=o.outputs[0].value;return`${Amount.wmcc(n-t,!0)} wmcc`}},Info.prototype.getExpTransactions=async function(){let t="",e=null;const{time:o}=this.explorer.details.block,{txs:n}=this.explorer.details.block;for(let i of n){const n=new Date(1e3*o).format("M d, Y, g:i:s A"),s=i.hash("hex");t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="2"><a class='tx r_goToExp'>${s}</a><i class="glyph-icon flaticon-copy" value=${s} title="Copy"></i>\n      </th><th>${n}</th></tr><tr><td>`;const{details:r,totalout:a,totalin:l}=await this.toDetails(i);t+=toTxTable(r),t+=`</td></tr><tr><td colspan='2'>${e=i.isCoinbase()?`(Size: ${i.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(l-a,!0)} wmcc, Size: ${i.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(a,!0)} wmcc</td></tr></table>`}return t},Info.prototype.setExpAddress=async function(t){try{const e=Address.fromString(t),o=await this.node.chain.getMetaByAddress(t),n=await this.node.chain.getCoinsByAddress(t),i=await this.node.mempool.getAllMetaByAddress(e);return o.push.apply(o,filtermeta(i)),o.sort(compare),this.explorer.details={address:e,metatx:o,coins:n},e||!1}catch(t){return!1}},Info.prototype.getExpAddress=function(){return`(${this.explorer.details.address})`},Info.prototype.getExpAddressSummary=function(){const{address:t,metatx:e,coins:o}=this.explorer.details;let n="",i=0;const s=$('<div id="qrcode"></div>').qrcode(t.hash.toString("hex"))[0].childNodes[0].toDataURL("image/png");for(let t of o)i+=t.value;let r=0;for(let o of e)for(let e of o.tx.outputs){let o=e.getAddress()?e.getAddress().hash:Buffer.alloc(0);t.hash.equals(o)&&(r+=e.value)}return n+='<table class="summary address"><tr><th colspan="5">Summary</th></tr>',n+=`<tr><td>Number of Transactions</td><td><span>${e.length}</span></td><td></td>`,n+=`<td>Total Received</td><td><span>${Amount.wmcc(r,!0)} wmcc</span></td></tr>`,n+=`<tr><td>Address Hash 160</td><td><span class='address'>${t.hash.toString("hex")}</span></td><td></td>`,n+=`<td>Final Balance</td><td><span>${Amount.wmcc(i,!0)} wmcc</span></td></tr>`,n+=`</table><img src="${s}"/>`},Info.prototype.getExpAdressTransactions=async function(t,e){t=parseInt(t)||50,e=parseInt(e)||0;let o="",n=null;const{metatx:i,address:s}=this.explorer.details,r=t+e>i.length?i.length:e+t;for(let t=e;t<r;t++){const e=new Date(1e3*(i[t].time||i[t].mtime)).format("M d, Y, g:i:s A"),r=i[t].tx.hash("hex");o+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',o+=`<tr><th colspan="2"><a class='tx r_goToExp${i[t].block?"":" red' title='Unconfirmed transaction"}'>${r}</a>\n      <i class="glyph-icon flaticon-copy" value=${r} title="Copy"></i></th><th>${e}</th></tr><tr><td>`;const{details:a,totalout:l,totalin:c}=await this.toDetails(i[t].tx);o+=toTxTable(a,s.toString()),o+=`</td></tr><tr><td colspan='2'>${n=i[t].tx.isCoinbase()?`(Size: ${i[t].tx.getVirtualSize()} bytes)`:`(Fee: ${Amount.wmcc(c-l,!0)} wmcc, Size: ${i[t].tx.getVirtualSize()} bytes)`}</td><td>${Amount.wmcc(l,!0)} wmcc</td></tr></table>`}if(!o)return`<div class='empty'>No transaction found for address: <a>${s}</a></div>`;return o+=page(i.length,e,t,"r_getExpAdressTransactions")},Info.prototype.setExpTransaction=async function(t){try{return this.explorer.details=await this.node.chain.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpTransaction=function(){return`(${this.explorer.details.tx.hash("hex")})`},Info.prototype.getExpTransactionSummary=async function(){let t="";const{tx:e,time:o,mtime:n,height:i,block:s}=this.explorer.details,r=new Date(1e3*(o||n)).format("M d, Y, g:i:s A"),{details:a,totalout:l,totalin:c}=await this.toDetails(e);let h=0,p=0;e.isCoinbase()||(h=Amount.wmcc(c,!0),p=c-l);const u=p>0?Amount.wmcc(policy.getRate(e.getVirtualSize(),p),!0):0,d=p>0?Amount.wmcc(policy.getRate(e.getWeight(),p),!0):0,f=i<0?"N/A":i,g=i<0?"":util.revHex(s),m=i<0?"Unconfirmed Transaction":this.node.chain.height-i+1;return t+='<table class="summary"><tr><th colspan="5">Summary</th></tr>',t+=`<tr><td>Size</td><td><span>${e.getVirtualSize()} bytes</span></td><td></td>`,t+=`<td>Total Input</td><td><span>${h} wmcc</span></td></tr>`,t+=`<tr><td>Weight</td><td><span>${e.getWeight()} bytes</span></td><td></td>`,t+=`<td>Total Output</td><td><span>${Amount.wmcc(l,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Received Time</td><td><span>${r}</span></td><td></td>`,t+=`<td>Fees</td><td><span>${Amount.wmcc(p,!0)} wmcc</span></td></tr>`,t+=`<tr><td>Included In Block</td><td><span${i<0?"":" class='block r_goToExp"}' title='${g}'>${f}</span></td><td></td>`,t+=`<td>Fee per kilobyte</td><td><span>${u} wmcc/kb</span></td></tr>`,t+=`<tr><td>Confirmations</td><td><span>${m}</span></td><td></td>`,t+=`<td>Fee per weight unit</td><td><span>${d} wmcc/kwu</span></td></tr>`,t+="</table>"},Info.prototype.getExpTransactionTable=async function(){let t="";const{tx:e}=this.explorer.details,o=e.hash("hex");t+='<table class="transaction"><colgroup><col/><col/><col/></colgroup>',t+=`<tr><th colspan="3"><a class='tx'>${o}</a><i class="glyph-icon flaticon-copy" value=${o} title="Copy"></i></th></tr><tr><td>`;const{details:n}=await this.toDetails(e);return t+=toTxTable(n),t+="</td></tr></table>"},Info.prototype.getExpScripts=function(){let t="";const{inputs:e,outputs:o}=this.explorer.details.tx;t+='<div class="scripts">',"coinbase"===e[0].getType()?t+="<h2>Coinbase</h2>":t+="<h2>Input Scripts</h2><div>";for(let o of e){const e=o.script.toJSON(),n=o.witness.toString(),i=o.script.getCommitment();e&&(t+=`<h3>${o.script.getInputTypeVal()}</h3>`,t+=`<p>${e}</p>`),i&&(t+="<h3>Commitment hash</h3>",t+=`<p>${i.toString("hex")}</p>`),n&&(t+=`<h3>${o.witness.getInputTypeVal()}</h3>`,t+=`<p>${n}</p>`)}t+='</div><div class="scripts"><h2>Output Scripts</h2>';for(let e of o){t+=`<h3>${e.getType()}</h3>`,t+=`<span>${e.script.toString()}</span>`;const o=e.script.getCommitment();o&&(t+="<h3>Commitment hash</h3>",t+=`<span>${o.toString("hex")}</span>`)}return`${t}</div>`},Info.prototype.setExpPending=async function(t){try{return this.explorer.details=await this.node.mempool.getMeta(t),this.explorer.details||!1}catch(t){return!1}},Info.prototype.getExpPending=function(){return`(${this.explorer.details.tx.hash("hex")})`},Info.prototype.toDetails=async function(t){let e=0,o=0,n=null;const i={output:{},input:{},pending:[]};for(let e of t.inputs){if(t.isCoinbase())continue;const s=await this.node.chain.getTX(e.prevout.hash);s?n=s.outputs:(n=await this.node.mempool.getTX(e.prevout.hash).outputs,i.pending.push(`${n[e.prevout.index].getAddress()}`));const r=n[e.prevout.index].value,a=`${n[e.prevout.index].getAddress()}`;i.input[a]?i.input[a]+=r:i.input[a]=r,o+=r}for(let o of t.outputs){const t=o.script.getAddress()?`${o.script.getAddress()}`:"unknown";i.output[t]?i.output[t]+=o.value:i.output[t]=o.value,e+=o.value}return{details:i,totalin:o,totalout:e}},Info.prototype.isExpHome=function(t){this.explorer.isHome=t},Info.prototype.resetExplorer=function(){this.explorer.details=!1},Info.prototype.getInfoUpdate=function(){let t;const e=__webpack_require__(15).update,o=e.major,n=e.minor;t=`<h2>Major Update ${o.version}</h2><table>`;for(let e of o.info)t+=`<tr><td>${e}</td></tr>`;t+=`</table><h2>Minor Update ${n.version}</h2><table>`;for(let e of n.info)t+=`<tr><td>${e}</td></tr>`;return t+="</table>"},Info.prototype.getInfoClient=function getInfoClient(){let html;const OS=__webpack_require__(8),App=eval("require")("../package.json"),Core=eval("require")("../node_modules/wmcc-core/package.json");return html="<h2>Application Information</h2><table>",html+=`<tr><td>Client Name</td><td>${App.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${App.version}</td></tr>`,html+=`<tr><td>Operating System</td><td>${OS.type()} ${OS.release()} ${OS.arch()}</td></tr>`,html+=`<tr><td>Release Date</td><td>${App.release}</td></tr></table>`,html+="<h2>Core Information</h2><table>",html+=`<tr><td>Client Name</td><td>${Core.name}</td></tr>`,html+=`<tr><td>Client Version</td><td>${Core.version}</td></tr>`,html+=`<tr><td>Release Date</td><td>${Core.release}</td></tr></table>`},Info.prototype.getInfoServer=async function(){let t;const e=Core.http.Client(),o=await e.getInfo(),n=new Date(1e3*o.time.system).format("M j, Y, g:i a"),i=new Date(1e3*this.node.chain.tip.time).format("M j, Y, g:i a");return t=`<h2>General</h2><table><tr><td>Version</td><td>${o.version}</td></tr>`,t+=`<tr><td>Network</td><td>${o.network}</td></tr>`,t+=`<tr><td>Data Directory</td><td>${this.node.chain.db.options.prefix}</td></tr>`,t+=`<tr><td>Time</td><td>${n}</td></tr>`,t+=`<tr><td>Uptime</td><td>${age(o.time.uptime,!0)}</td></tr>`,t+="</table><h2>Network</h2><table>",t+=`<tr><td>Host</td><td>${o.pool.host}</td></tr>`,t+=`<tr><td>Port</td><td>${o.pool.port}</td></tr>`,t+=`<tr><td>Agent</td><td>${o.pool.agent}</td></tr>`,t+=`<tr><td>Services</td><td>${o.pool.services}</td></tr>`,t+=`<tr><td>Number of Connections</td><td>In: ${o.pool.inbound} / Out: ${o.pool.outbound}</td></tr>`,t+="</table><h2>Block Chain</h2><table>",t+=`<tr><td>Current Height</td><td>${o.chain.height}</td></tr>`,t+=`<tr><td>Last Block Time</td><td>${i}</td></tr>`,t+=`<tr><td>Progress</td><td>${(100*o.chain.progress).toFixed(2)} <a style='font-family:Ubuntu, sans-serif;'>%</a></td></tr>`,t+="</table><h2>Mempool</h2><table>",t+=`<tr><td>Number of Transactions</td><td>${o.mempool.tx}</td></tr>`,t+=`<tr><td>Memory Usage</td><td>${o.mempool.size}</td></tr></table>`},Info.prototype.getInfoPublicIP=async function(){return await Core.net.external.getIPv4()},Info.prototype.getConfigBasic=async function(){let t="";const e=this.node.config,o=e.getDefault();for(let n of Object.keys(o))if(n){t+=`<h2>${n}</h2>`;for(let i in o[n]){const s=o[n][i][0],r=o[n][i][1],a=o[n][i][2]?"":" disabled",l=o[n][i][3]?` ${o[n][i][3]}`:"",c=i.replace(/-/g,"").toLowerCase(),h=e.data[c]||s;let p;if("bool"===r){p=`<div class="checkbox${a}">\n                 <input type="checkbox" id="checkbox-${i}"${"true"===h?" checked":""}${a} name="${i}" />\n                 <label class="checkbox-off" for="checkbox-${i}"></label></div>`}else p=`<input type='text' class='${r}${l}' value='${h}'${a} name="${i}" />`;t+=`<div>${i} ${s?" (default: "+s+")":""}${p}</div>`}}return t+="<p class='result'></p><submit class=\"button s_configSave\">UPDATE</submit>"},Info.prototype.getStratumInfo=function(){let t;const e=this.node.stratum.options,o=this.node.stratum.inbound.size,n=new Date(1e3*this.node.stratum.lastActive).format("M j, Y, g:i a");return t=`<table><tr><td>Data Directory</td><td>${e.prefix}</td></tr>`,t+=`<tr><td>Public Host</td><td>${e.publicHost}</td></tr>`,t+=`<tr><td>Public Port</td><td>${e.publicPort}</td></tr>`,t+=`<tr><td>Max Inbound</td><td>${e.maxInbound}</td></tr>`,t+=`<tr><td>Difficulty</td><td>${e.difficulty}</td></tr>`,t+=`<tr><td>Last Active</td><td>${n}</td></tr>`,t+=`<tr><td>Connected Workers</td><td>${o}</td></tr></table>`},Info.prototype.getStratumUsers=function(){let t;const e=this.node.stratum.userdb;return e.size?(t="<table class='workerlist'><tr><th>Worker Name</th><th>Password</th><th>Remove Worker</th></tr>",e.map.forEach((e,o,n)=>{t+=`<tr><td>${o}</td><td>★★★★★</td>`,t+='<td><i class="glyph-icon flaticon-remove s_stratumRemoveWorker" title="Remove Worker"></i></td></tr>'}),t+="</table>"):"<table><tr><th>No worker found in userdb.</th></tr></table>"},module.exports=Info},function(t,e){t.exports=require("os")},function(t,e,o){"use strict";function n(t){if(!(this instanceof n))return new n(t);g.call(this,t),this.spv=!1,this.chain=new r({network:this.network,logger:this.logger,workers:this.workers,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),forceFlags:this.config.bool("force-flags"),bip91:this.config.bool("bip91"),bip148:this.config.bool("bip148"),prune:this.config.bool("prune"),checkpoints:this.config.bool("checkpoints"),coinCache:this.config.mb("coin-cache"),entryCache:this.config.uint("entry-cache"),indexTX:this.config.bool("index-tx"),indexAddress:this.config.bool("index-address")}),this.fees=new a(this.logger),this.fees.init(),this.mempool=new l({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,fees:this.fees,db:this.config.str("db"),prefix:this.config.prefix,persistent:this.config.bool("persistent-mempool"),maxSize:this.config.mb("mempool-size"),limitFree:this.config.bool("limit-free"),limitFreeRelay:this.config.uint("limit-free-relay"),requireStandard:this.config.bool("require-standard"),rejectAbsurdFees:this.config.bool("reject-absurd-fees"),replaceByFee:this.config.bool("replace-by-fee"),indexAddress:this.config.bool("index-address")}),this.pool=new c({network:this.network,logger:this.logger,chain:this.chain,mempool:this.mempool,prefix:this.config.prefix,selfish:this.config.bool("selfish"),compact:this.config.bool("compact"),bip37:this.config.bool("bip37"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),maxInbound:this.config.uint("max-inbound"),proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),publicHost:this.config.str("public-host"),publicPort:this.config.uint("public-port"),host:this.config.str("host"),port:this.config.uint("port"),listen:this.config.bool("listen"),persistent:this.config.bool("persistent")}),this.miner=new h({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,mempool:this.mempool,address:this.config.array("coinbase-address"),coinbaseFlags:this.config.str("coinbase-flags"),preverify:this.config.bool("preverify"),maxWeight:this.config.uint("max-weight"),reservedWeight:this.config.uint("reserved-weight"),reservedSigops:this.config.uint("reserved-sigops")}),this.rpc=new p(this),s.unsupported||(this.http=new s({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),port:this.config.uint("http-port"),apiKey:this.config.str("api-key"),noAuth:this.config.bool("no-auth")})),this.client=new m(this),this.walletdb=new u({network:this.network,logger:this.logger,workers:this.workers,client:this.client,prefix:this.config.prefix,db:this.config.str(["wallet-db","db"]),maxFiles:this.config.uint("wallet-max-files"),cacheSize:this.config.mb("wallet-cache-size"),witness:this.config.bool("wallet-witness"),checkpoints:this.config.bool("wallet-checkpoints"),startHeight:this.config.uint("wallet-start-height"),wipeNoReally:this.config.bool("wallet-wipe-no-really"),apiKey:this.config.str(["wallet-api-key","api-key"]),walletAuth:this.config.bool("wallet-auth"),noAuth:this.config.bool(["wallet-no-auth","no-auth"]),ssl:this.config.str("wallet-ssl"),host:this.config.str("wallet-host"),port:this.config.uint("wallet-port"),spv:this.spv,verify:this.spv,listen:!1}),this.stratum=new d({node:this,prefix:this.config.prefix,logger:this.logger,host:this.config.str("stratum-host"),port:this.config.uint("stratum-port"),publicHost:this.config.str("stratum-public-host"),publicPort:this.config.uint("stratum-public-port"),maxInbound:this.config.uint("stratum-max-inbound"),difficulty:this.config.uint("stratum-difficulty"),dynamic:this.config.bool("stratum-dynamic"),password:this.config.str("stratum-password")}),this.auth=new f({network:this.network,logger:this.logger,walletdb:this.walletdb,chain:this.chain,otp:this.config.bool("auth-otp"),alg:this.config.str("hsm-alg"),hash:this.config.str("hsm-hash"),iter:this.config.str("hsm-iter"),r:this.config.str("hsm-r"),p:this.config.str("hsm-p"),length:this.config.str("hsm-length")}),this.http&&this.walletdb.http&&this.walletdb.http.attach(this.http),this.walletdb.rpc.attach(this.rpc),this.info=new w(this),this.attach=new y(this),this._init()}const i=o(0),s=i.http.Server,{Chain:r}=i.blockchain,{Fees:a,Mempool:l}=i.txmempool,{Pool:c}=i.net,{Miner:h}=i.mining,{RPC:p}=i.http,{WalletDB:u}=i.wallet,{Stratum:d}=i.stratum,{Auth:f}=o(14).Credential,g=o(4),m=o(6),y=o(2),w=o(7);Object.setPrototypeOf(n.prototype,g.prototype),n.prototype._init=function(){this.chain.on("error",t=>this.error(t)),this.mempool.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.miner.on("error",t=>this.error(t)),this.walletdb.on("error",t=>this.error(t)),this.stratum.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.mempool.on("tx",t=>{this.miner.cpu.notifyEntry(),this.emit("tx",t)}),this.chain.hook("connect",async(t,e)=>{try{await this.mempool._addBlock(t,e.txs)}catch(t){this.error(t)}this.emit("block",e),this.emit("connect",t,e)}),this.chain.hook("disconnect",async(t,e)=>{try{await this.mempool._removeBlock(t,e.txs)}catch(t){this.error(t)}this.emit("disconnect",t,e)}),this.chain.hook("reorganize",async(t,e)=>{try{await this.mempool._handleReorg()}catch(t){this.error(t)}this.emit("reorganize",t,e)}),this.chain.hook("reset",async t=>{try{await this.mempool._reset()}catch(t){this.error(t)}this.emit("reset",t)}),this.loadPlugins()},n.prototype._open=async function(){await this.chain.open(),await this.mempool.open(),await this.miner.open(),await this.pool.open(),await this.walletdb.open(),await this.stratum.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")},n.prototype._close=async function(){this.http&&await this.http.close(),await this.closePlugins(),await this.stratum.close(),await this.walletdb.close(),await this.pool.close(),await this.miner.close(),await this.mempool.close(),await this.chain.close(),this.logger.info("Node is closed.")},n.prototype.scan=function(t,e,o){return this.chain.scan(t,e,o)},n.prototype.broadcast=async function(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}},n.prototype.sendTX=async function(t){let e;try{e=await this.mempool.addTX(t)}catch(e){if("VerifyError"===e.type&&0===e.score)return this.error(e),this.logger.warning("Verification failed for tx: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);throw e}if(e)return this.logger.warning("TX was orphaned in mempool: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);this.pool.options.selfish&&this.pool.broadcast(t)},n.prototype.relay=async function(t){try{await this.sendTX(t)}catch(t){this.error(t)}},n.prototype.connect=function(){return this.pool.connect()},n.prototype.disconnect=function(){return this.pool.disconnect()},n.prototype.startSync=function(){return this.pool.startSync()},n.prototype.stopSync=function(){return this.pool.stopSync()},n.prototype.getBlock=function(t){return this.chain.getBlock(t)},n.prototype.getCoin=async function(t,e){const o=this.mempool.getCoin(t,e);return o||(this.mempool.isSpent(t,e)?null:await this.chain.getCoin(t,e))},n.prototype.getCoinsByAddress=async function(t){const e=this.mempool.getCoinsByAddress(t),o=await this.chain.getCoinsByAddress(t),n=[];for(const t of o){this.mempool.isSpent(t.hash,t.index)||n.push(t)}for(const t of e)n.push(t);return n},n.prototype.getMetaByAddress=async function(t){const e=this.mempool.getMetaByAddress(t);return(await this.chain.getMetaByAddress(t)).concat(e)},n.prototype.getMeta=async function(t){const e=this.mempool.getMeta(t);return e||await this.chain.getMeta(t)},n.prototype.getMetaView=async function(t){return-1===t.height?this.mempool.getSpentView(t.tx):this.chain.getSpentView(t.tx)},n.prototype.getTXByAddress=async function(t){const e=await this.getMetaByAddress(t),o=[];for(const t of e)o.push(t.tx);return o},n.prototype.getTX=async function(t){const e=await this.getMeta(t);return e?e.tx:null},n.prototype.hasTX=async function(t){return!!this.mempool.hasEntry(t)||await this.chain.hasTX(t)},n.prototype._on=async function(t,e,o){return await this.attach.on(t,e,o)},n.prototype._emit=async function(t,e){return await this.attach.emit(t,e)},n.prototype._call=async function(t,e,o){return o&&Object.keys(o).length?await this[e][t](...Object.values(o)):await this[e][t]()},t.exports=n},function(t,e){},function(t,e,o){"use strict";const n=e;n.cache=function(){},n.Node=o(12),n.attach=o(2),n.config=o(3),n.fullnode=o(9),n.info=o(7),n.logger=o(5),n.node=o(4),n.nodeclient=o(6),n.spvnode=o(10),global.wmcc_node=n},function(t,e,o){"use strict";e.Attach=o(2),e.Config=o(3),e.FullNode=o(9),e.Info=o(7),e.Logger=o(5),e.Node=o(4),e.NodeClient=o(6),e.SpvNode=o(10)},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("wmcc-credential")},function(t,e){t.exports=require("../update/information.json")}]);